<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AgileRTOS (zrtos): FAT16 support</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">AgileRTOS (zrtos)<span id="projectnumber">&#160;Version 0.8.0 (ghostbuster)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__fat16.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Topics</a> &#124;
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">FAT16 support</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for FAT16 support:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16.png" border="0" usemap="#agroup____fat16" alt=""/></div>
<map name="agroup____fat16" id="agroup____fat16">
<area shape="rect" title=" " alt="" coords="5,89,112,116"/>
<area shape="rect" href="group__fat16__config.html" title="Preprocessor defines to configure the FAT16 implementation." alt="" coords="301,5,438,32"/>
<area shape="rect" href="group__fat16__dir.html" title="Functions for managing directories." alt="" coords="285,56,454,83"/>
<area shape="rect" href="group__fat16__file.html" title="Functions for managing files." alt="" coords="302,112,437,139"/>
<area shape="rect" href="group__fat16__fs.html" title="Basic functions for handling a FAT16 filesystem." alt="" coords="317,169,422,196"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Topics</h2></td></tr>
<tr class="memitem:group__fat16__config" id="r_group__fat16__config"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fat16__config.html">FAT16 configuration</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__fat16__fs" id="r_group__fat16__fs"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fat16__fs.html">FAT16 access</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__fat16__file" id="r_group__fat16__file"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fat16__file.html">FAT16 file functions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__fat16__dir" id="r_group__fat16__dir"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fat16__dir.html">FAT16 directory functions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:fat16_8h" id="r_fat16_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fat16_8h.html">fat16.h</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:fat16__header_8h" id="r_fat16__header_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fat16__header_8h.html">fat16_header.h</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfat16__header__struct.html">fat16_header_struct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfat16__file__struct.html">fat16_file_struct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfat16__read__callback__arg.html">fat16_read_callback_arg</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfat16__usage__count__callback__arg.html">fat16_usage_count_callback_arg</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga554cb707673a9db9d6a668af97600d04" id="r_ga554cb707673a9db9d6a668af97600d04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga554cb707673a9db9d6a668af97600d04">fat16_open</a> (struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *fs, struct partition_struct *partition)</td></tr>
<tr class="separator:ga554cb707673a9db9d6a668af97600d04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6588833571e6ef0f5d094b8ff56a5985" id="r_ga6588833571e6ef0f5d094b8ff56a5985"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6588833571e6ef0f5d094b8ff56a5985">fat16_close</a> (struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *fs)</td></tr>
<tr class="separator:ga6588833571e6ef0f5d094b8ff56a5985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2871189b28d8d45baea4c913b0f8438" id="r_gaa2871189b28d8d45baea4c913b0f8438"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa2871189b28d8d45baea4c913b0f8438">fat16_open_file</a> (struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *fd, struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *fs, const struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *dir_entry)</td></tr>
<tr class="separator:gaa2871189b28d8d45baea4c913b0f8438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2b2812041f489bc7913bfa5cbcf0172b" id="r_ga2b2812041f489bc7913bfa5cbcf0172b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2b2812041f489bc7913bfa5cbcf0172b">fat16_close_file</a> (struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *fd)</td></tr>
<tr class="separator:ga2b2812041f489bc7913bfa5cbcf0172b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0af2ef3d690626a5640a334cefbb27a6" id="r_ga0af2ef3d690626a5640a334cefbb27a6"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0af2ef3d690626a5640a334cefbb27a6">fat16_read_file</a> (struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *fd, uint8_t *buffer, uint16_t buffer_len)</td></tr>
<tr class="separator:ga0af2ef3d690626a5640a334cefbb27a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f0c785a47b1cf070839b5edec2c6f65" id="r_ga4f0c785a47b1cf070839b5edec2c6f65"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4f0c785a47b1cf070839b5edec2c6f65">fat16_write_file</a> (struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *fd, const uint8_t *buffer, uint16_t buffer_len)</td></tr>
<tr class="separator:ga4f0c785a47b1cf070839b5edec2c6f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf1511fd1a5419d0828265566dc5d33e4" id="r_gaf1511fd1a5419d0828265566dc5d33e4"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf1511fd1a5419d0828265566dc5d33e4">fat16_seek_file</a> (struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *fd, int32_t *offset, uint8_t whence)</td></tr>
<tr class="separator:gaf1511fd1a5419d0828265566dc5d33e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23740742fa60ca148ef098caac7085c0" id="r_ga23740742fa60ca148ef098caac7085c0"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga23740742fa60ca148ef098caac7085c0">fat16_resize_file</a> (struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *fd, uint32_t size)</td></tr>
<tr class="separator:ga23740742fa60ca148ef098caac7085c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61fa0c22ba72801630b6472f87f7f9d7" id="r_ga61fa0c22ba72801630b6472f87f7f9d7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga61fa0c22ba72801630b6472f87f7f9d7">fat16_open_dir</a> (struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *dd, struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *fs, const struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *dir_entry)</td></tr>
<tr class="separator:ga61fa0c22ba72801630b6472f87f7f9d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga95f491a5a0b6438781aefaedc250e926" id="r_ga95f491a5a0b6438781aefaedc250e926"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga95f491a5a0b6438781aefaedc250e926">fat16_close_dir</a> (struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *dd)</td></tr>
<tr class="separator:ga95f491a5a0b6438781aefaedc250e926"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga73c8f0598e8224736b09644c48cf2970" id="r_ga73c8f0598e8224736b09644c48cf2970"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga73c8f0598e8224736b09644c48cf2970">fat16_read_dir</a> (struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *dd, struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *dir_entry)</td></tr>
<tr class="separator:ga73c8f0598e8224736b09644c48cf2970"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaed63addc9b9a3d5137f3b552abb42d8" id="r_gaaed63addc9b9a3d5137f3b552abb42d8"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaaed63addc9b9a3d5137f3b552abb42d8">fat16_reset_dir</a> (struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *dd)</td></tr>
<tr class="separator:gaaed63addc9b9a3d5137f3b552abb42d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad2e7cbfa7a5f7c2893b7999663599901" id="r_gad2e7cbfa7a5f7c2893b7999663599901"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad2e7cbfa7a5f7c2893b7999663599901">fat16_set_dir</a> (struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *dd, uint16_t offset)</td></tr>
<tr class="separator:gad2e7cbfa7a5f7c2893b7999663599901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf8029e3ec633902d08e8204d13afc350" id="r_gaf8029e3ec633902d08e8204d13afc350"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf8029e3ec633902d08e8204d13afc350">fat16_create_file</a> (struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *parent, const char *file, struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *dir_entry)</td></tr>
<tr class="separator:gaf8029e3ec633902d08e8204d13afc350"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae060faccbbeca802afe86be2f4d5b485" id="r_gae060faccbbeca802afe86be2f4d5b485"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae060faccbbeca802afe86be2f4d5b485">fat16_delete_file</a> (struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *fs, struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *dir_entry)</td></tr>
<tr class="separator:gae060faccbbeca802afe86be2f4d5b485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0045fe378de2f7c52b528f985e1891a6" id="r_ga0045fe378de2f7c52b528f985e1891a6"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0045fe378de2f7c52b528f985e1891a6">fat16_get_dir_entry_of_path</a> (struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *fs, const char *path, struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *dir_entry)</td></tr>
<tr class="separator:ga0045fe378de2f7c52b528f985e1891a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8af3c3535929e19b0039e07f1976cec7" id="r_ga8af3c3535929e19b0039e07f1976cec7"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8af3c3535929e19b0039e07f1976cec7">fat16_get_fs_size</a> (const struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *fs)</td></tr>
<tr class="separator:ga8af3c3535929e19b0039e07f1976cec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2f8ff07cca44ecb6770b12a58b6cd8c7" id="r_ga2f8ff07cca44ecb6770b12a58b6cd8c7"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2f8ff07cca44ecb6770b12a58b6cd8c7">fat16_get_fs_free</a> (const struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *fs)</td></tr>
<tr class="separator:ga2f8ff07cca44ecb6770b12a58b6cd8c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa25986550d47370f582118a9ef6eae24" id="r_gaa25986550d47370f582118a9ef6eae24"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa25986550d47370f582118a9ef6eae24">find_file_in_dir</a> (struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *fs, struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *dd, const char *name, struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *dir_entry)</td></tr>
<tr class="separator:gaa25986550d47370f582118a9ef6eae24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacdc9da639a6ccdac9847aaba559f9ef0" id="r_gacdc9da639a6ccdac9847aaba559f9ef0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gacdc9da639a6ccdac9847aaba559f9ef0">open_file_in_dir</a> (struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *fd, struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *fs, struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *dd, const char *name)</td></tr>
<tr class="separator:gacdc9da639a6ccdac9847aaba559f9ef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e2318395c5e0c965a48adecb9c20196" id="r_ga3e2318395c5e0c965a48adecb9c20196"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3e2318395c5e0c965a48adecb9c20196">fat16_file_size</a> (struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *file)</td></tr>
<tr class="separator:ga3e2318395c5e0c965a48adecb9c20196"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This module implements FAT16 read and write access.</p>
<p>The following features are supported:</p><ul>
<li>File names up to 31 characters long.</li>
<li>Unlimited depth of subdirectories.</li>
<li>Short 8.3 and long filenames.</li>
<li>Creating and deleting files.</li>
<li>Reading and writing from and to files.</li>
<li>File resizing.</li>
<li>File sizes of up to 4 gigabytes. </li>
</ul>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga6588833571e6ef0f5d094b8ff56a5985" name="ga6588833571e6ef0f5d094b8ff56a5985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6588833571e6ef0f5d094b8ff56a5985">&#9670;&#160;</a></span>fat16_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fat16_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes a FAT16 filesystem. </p>
<p>When this function returns, the given filesystem descriptor will be invalid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The filesystem to close. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__fs.html#ga554cb707673a9db9d6a668af97600d04" title="Opens a FAT16 filesystem.">fat16_open</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l00127">127</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  127</span>                                             {</div>
<div class="line"><span class="lineno">  128</span>  memset(fs, 0, <span class="keyword">sizeof</span>(*fs));</div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  130</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga95f491a5a0b6438781aefaedc250e926" name="ga95f491a5a0b6438781aefaedc250e926"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga95f491a5a0b6438781aefaedc250e926">&#9670;&#160;</a></span>fat16_close_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fat16_close_dir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dd</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes a directory descriptor. </p>
<p>This function destroys a directory descriptor which was previously obtained by calling <a class="el" href="group__fat16__dir.html#ga61fa0c22ba72801630b6472f87f7f9d7" title="Opens a directory.">fat16_open_dir()</a>. When this function returns, the given descriptor will be invalid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dd</td><td>The directory descriptor to close. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__dir.html#ga61fa0c22ba72801630b6472f87f7f9d7" title="Opens a directory.">fat16_open_dir</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01236">1236</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1236</span>                                                  {</div>
<div class="line"><span class="lineno"> 1237</span>  <span class="comment">//nop</span></div>
<div class="line"><span class="lineno"> 1238</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_ga95f491a5a0b6438781aefaedc250e926_icgraph.png" border="0" usemap="#agroup__fat16_ga95f491a5a0b6438781aefaedc250e926_icgraph" alt=""/></div>
<map name="agroup__fat16_ga95f491a5a0b6438781aefaedc250e926_icgraph" id="agroup__fat16_ga95f491a5a0b6438781aefaedc250e926_icgraph">
<area shape="rect" title="Closes a directory descriptor." alt="" coords="185,13,293,40"/>
<area shape="rect" href="group__fat16__file.html#ga0045fe378de2f7c52b528f985e1891a6" title="Retrieves the directory entry of a path." alt="" coords="5,5,137,48"/>
<area shape="poly" title=" " alt="" coords="169,29,137,29,137,24,169,24"/>
</map>
</div>

</div>
</div>
<a id="ga2b2812041f489bc7913bfa5cbcf0172b" name="ga2b2812041f489bc7913bfa5cbcf0172b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2b2812041f489bc7913bfa5cbcf0172b">&#9670;&#160;</a></span>fat16_close_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fat16_close_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fd</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>The file handle of the file to close. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__file.html#gaa2871189b28d8d45baea4c913b0f8438" title="Opens a file on a FAT16 filesystem.">fat16_open_file</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l00813">813</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  813</span>                                                    {</div>
<div class="line"><span class="lineno">  814</span>  <span class="comment">//null op</span></div>
<div class="line"><span class="lineno">  815</span>    fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a2e6afeba0fa2950162794e5357d686e8">magic_cookie</a>=0x00000000;</div>
<div class="line"><span class="lineno">  816</span>}</div>
<div class="ttc" id="astructfat16__file__struct_html_a2e6afeba0fa2950162794e5357d686e8"><div class="ttname"><a href="structfat16__file__struct.html#a2e6afeba0fa2950162794e5357d686e8">fat16_file_struct::magic_cookie</a></div><div class="ttdeci">unsigned int magic_cookie</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00157">fat16_header.h:157</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaf8029e3ec633902d08e8204d13afc350" name="gaf8029e3ec633902d08e8204d13afc350"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf8029e3ec633902d08e8204d13afc350">&#9670;&#160;</a></span>fat16_create_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t fat16_create_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>parent</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>file</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dir_entry</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a file. </p>
<p>Creates a file and obtains the directory entry of the new file. If the file to create already exists, the directory entry of the existing file will be returned within the dir_entry parameter.</p>
<dl class="section note"><dt>Note</dt><dd>The file name is not checked for invalid characters.</dd>
<dd>
The generation of the short 8.3 file name is quite simple. The first eight characters are used for the filename. The extension, if any, is made up of the first three characters following the last dot within the long filename. If the filename (without the extension) is longer than eight characters, the lower byte of the cluster number replaces the last two characters to avoid name clashes. In any other case, it is your responsibility to avoid name clashes.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">parent</td><td>The handle of the directory in which to create the file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>The name of the file to create. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dir_entry</td><td>The directory entry to fill for the new file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on failure, 1 on success. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__file.html#gae060faccbbeca802afe86be2f4d5b485" title="Deletes a file or directory.">fat16_delete_file</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01529">1529</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1530</span>{</div>
<div class="line"><span class="lineno"> 1531</span><span class="preprocessor">    #if FAT16_WRITE_SUPPORT</span></div>
<div class="line"><span class="lineno"> 1532</span>        <span class="keywordflow">if</span>(!parent || !file || !file[0])</div>
<div class="line"><span class="lineno"> 1533</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1534</span>    </div>
<div class="line"><span class="lineno"> 1535</span>        <span class="comment">/* check if the file already exists */</span></div>
<div class="line"><span class="lineno"> 1536</span>        <span class="keywordflow">while</span>(1)</div>
<div class="line"><span class="lineno"> 1537</span>        {</div>
<div class="line"><span class="lineno"> 1538</span>            <span class="keywordflow">if</span>(!<a class="code hl_function" href="group__fat16__dir.html#ga73c8f0598e8224736b09644c48cf2970">fat16_read_dir</a>(parent, dir_entry))</div>
<div class="line"><span class="lineno"> 1539</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1540</span>    </div>
<div class="line"><span class="lineno"> 1541</span>            <span class="keywordflow">if</span>(strcmp(file, dir_entry-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a9f625c7e8ac92bd268c62089f71480d0">long_name</a>) == 0)</div>
<div class="line"><span class="lineno"> 1542</span>            {</div>
<div class="line"><span class="lineno"> 1543</span>                <a class="code hl_function" href="group__fat16__dir.html#gaaed63addc9b9a3d5137f3b552abb42d8">fat16_reset_dir</a>(parent);</div>
<div class="line"><span class="lineno"> 1544</span>                <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 1545</span>            }</div>
<div class="line"><span class="lineno"> 1546</span>        }</div>
<div class="line"><span class="lineno"> 1547</span>    </div>
<div class="line"><span class="lineno"> 1548</span>        memset(dir_entry, 0, <span class="keyword">sizeof</span>(*dir_entry));</div>
<div class="line"><span class="lineno"> 1549</span>        strncpy(dir_entry-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a9f625c7e8ac92bd268c62089f71480d0">long_name</a>, file, <span class="keyword">sizeof</span>(dir_entry-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a9f625c7e8ac92bd268c62089f71480d0">long_name</a>) - 1);</div>
<div class="line"><span class="lineno"> 1550</span>    </div>
<div class="line"><span class="lineno"> 1551</span>        <span class="comment">/* search for a place where to write the directory entry to disk */</span></div>
<div class="line"><span class="lineno"> 1552</span>        uint8_t free_dir_entries_needed = strlen(file) / 13 + 1 + 1;</div>
<div class="line"><span class="lineno"> 1553</span>        uint8_t free_dir_entries_found = 0;</div>
<div class="line"><span class="lineno"> 1554</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structfat16__fs__struct.html">fat16_fs_struct</a>* fs = parent-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#a3e931a086f03c316195e59541679db6b">fs</a>;</div>
<div class="line"><span class="lineno"> 1555</span>        uint16_t cluster_num = parent-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#a5549da6db7a16c0a5c6b2016cf0826d6">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8bbd1a1339bd035f916ffe91420cc8ad">cluster</a>;</div>
<div class="line"><span class="lineno"> 1556</span>        uint32_t dir_entry_offset = 0;</div>
<div class="line"><span class="lineno"> 1557</span>        uint32_t offset = 0;</div>
<div class="line"><span class="lineno"> 1558</span>        uint32_t offset_to = 0;</div>
<div class="line"><span class="lineno"> 1559</span>    </div>
<div class="line"><span class="lineno"> 1560</span>        <span class="keywordflow">if</span>(cluster_num == 0)</div>
<div class="line"><span class="lineno"> 1561</span>        {</div>
<div class="line"><span class="lineno"> 1562</span>            <span class="comment">/* we read/write from the root directory entry */</span></div>
<div class="line"><span class="lineno"> 1563</span>            offset = fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a1e631311b2e65eef7f022196ec16aa18">root_dir_offset</a>;</div>
<div class="line"><span class="lineno"> 1564</span>            offset_to = fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a877f23793a9b6cf783f71bf31fb18bb1">cluster_zero_offset</a>;</div>
<div class="line"><span class="lineno"> 1565</span>            dir_entry_offset = offset;</div>
<div class="line"><span class="lineno"> 1566</span>        }</div>
<div class="line"><span class="lineno"> 1567</span>    </div>
<div class="line"><span class="lineno"> 1568</span>        <span class="keywordflow">while</span>(1)</div>
<div class="line"><span class="lineno"> 1569</span>        {</div>
<div class="line"><span class="lineno"> 1570</span>            <span class="keywordflow">if</span>(offset == offset_to)</div>
<div class="line"><span class="lineno"> 1571</span>            {</div>
<div class="line"><span class="lineno"> 1572</span>                <span class="keywordflow">if</span>(cluster_num == 0)</div>
<div class="line"><span class="lineno"> 1573</span>                <span class="comment">/* We iterated through the whole root directory entry</span></div>
<div class="line"><span class="lineno"> 1574</span><span class="comment">                * and could not find enough space for the directory entry.</span></div>
<div class="line"><span class="lineno"> 1575</span><span class="comment">                */</span></div>
<div class="line"><span class="lineno"> 1576</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1577</span>    </div>
<div class="line"><span class="lineno"> 1578</span>                <span class="keywordflow">if</span>(offset)</div>
<div class="line"><span class="lineno"> 1579</span>                {</div>
<div class="line"><span class="lineno"> 1580</span>                    <span class="comment">/* We reached a cluster boundary and have to</span></div>
<div class="line"><span class="lineno"> 1581</span><span class="comment">                    * switch to the next cluster.</span></div>
<div class="line"><span class="lineno"> 1582</span><span class="comment">                    */</span></div>
<div class="line"><span class="lineno"> 1583</span>    </div>
<div class="line"><span class="lineno"> 1584</span>                    uint16_t cluster_next = <a class="code hl_function" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a">fat16_get_next_cluster</a>(fs, cluster_num);</div>
<div class="line"><span class="lineno"> 1585</span>                    <span class="keywordflow">if</span>(!cluster_next)</div>
<div class="line"><span class="lineno"> 1586</span>                    {</div>
<div class="line"><span class="lineno"> 1587</span>                        cluster_next = <a class="code hl_function" href="group__fat16__fs.html#ga7c2bf1884a5d396916b4581e15eb6992">fat16_append_clusters</a>(fs, cluster_num, 1);</div>
<div class="line"><span class="lineno"> 1588</span>                        <span class="keywordflow">if</span>(!cluster_next)</div>
<div class="line"><span class="lineno"> 1589</span>                            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1590</span>    </div>
<div class="line"><span class="lineno"> 1591</span>                        <span class="comment">/* we appended a new cluster and know it is free */</span></div>
<div class="line"><span class="lineno"> 1592</span>                        dir_entry_offset = fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a877f23793a9b6cf783f71bf31fb18bb1">cluster_zero_offset</a> +</div>
<div class="line"><span class="lineno"> 1593</span>                        (uint32_t) (cluster_next - 2) * fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a724086964a23748a0585386c396b945e">cluster_size</a>;</div>
<div class="line"><span class="lineno"> 1594</span>    </div>
<div class="line"><span class="lineno"> 1595</span>                        <span class="comment">/* TODO: This cluster has to be zeroed in an efficient way, or at least</span></div>
<div class="line"><span class="lineno"> 1596</span><span class="comment">                        *       every 32th byte should be set to FAT16_DIRENTRY_DELETED.</span></div>
<div class="line"><span class="lineno"> 1597</span><span class="comment">                        */</span></div>
<div class="line"><span class="lineno"> 1598</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1599</span>                    }</div>
<div class="line"><span class="lineno"> 1600</span>                    cluster_num = cluster_next;</div>
<div class="line"><span class="lineno"> 1601</span>                }</div>
<div class="line"><span class="lineno"> 1602</span>    </div>
<div class="line"><span class="lineno"> 1603</span>                offset = fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a877f23793a9b6cf783f71bf31fb18bb1">cluster_zero_offset</a> +</div>
<div class="line"><span class="lineno"> 1604</span>                (uint32_t) (cluster_num - 2) * fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a724086964a23748a0585386c396b945e">cluster_size</a>;</div>
<div class="line"><span class="lineno"> 1605</span>                offset_to = offset + fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a724086964a23748a0585386c396b945e">cluster_size</a>;</div>
<div class="line"><span class="lineno"> 1606</span>                dir_entry_offset = offset;</div>
<div class="line"><span class="lineno"> 1607</span>                free_dir_entries_found = 0;</div>
<div class="line"><span class="lineno"> 1608</span>            }</div>
<div class="line"><span class="lineno"> 1609</span>    </div>
<div class="line"><span class="lineno"> 1610</span>            <span class="comment">/* read next lfn or 8.3 entry */</span></div>
<div class="line"><span class="lineno"> 1611</span>            uint8_t first_char;</div>
<div class="line"><span class="lineno"> 1612</span>            <span class="keywordflow">if</span>(!fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#a59ba2a9a21fc39f90358fe48baa5b923">partition</a>-&gt;device_read(offset, &amp;first_char, <span class="keyword">sizeof</span>(first_char)))</div>
<div class="line"><span class="lineno"> 1613</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1614</span>    </div>
<div class="line"><span class="lineno"> 1615</span>            <span class="comment">/* check if we found a free directory entry */</span></div>
<div class="line"><span class="lineno"> 1616</span>            <span class="keywordflow">if</span>(first_char == <a class="code hl_define" href="fat16_8h.html#a062d60991f5236f2dd1b323d7faeabe3">FAT16_DIRENTRY_DELETED</a> || !first_char)</div>
<div class="line"><span class="lineno"> 1617</span>            {</div>
<div class="line"><span class="lineno"> 1618</span>                <span class="comment">/* check if we have the needed number of available entries */</span></div>
<div class="line"><span class="lineno"> 1619</span>                ++free_dir_entries_found;</div>
<div class="line"><span class="lineno"> 1620</span>                <span class="keywordflow">if</span>(free_dir_entries_found &gt;= free_dir_entries_needed)</div>
<div class="line"><span class="lineno"> 1621</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1622</span>    </div>
<div class="line"><span class="lineno"> 1623</span>                offset += 32;</div>
<div class="line"><span class="lineno"> 1624</span>            }</div>
<div class="line"><span class="lineno"> 1625</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1626</span>            {</div>
<div class="line"><span class="lineno"> 1627</span>                offset += 32;</div>
<div class="line"><span class="lineno"> 1628</span>                dir_entry_offset = offset;</div>
<div class="line"><span class="lineno"> 1629</span>                free_dir_entries_found = 0;</div>
<div class="line"><span class="lineno"> 1630</span>            }</div>
<div class="line"><span class="lineno"> 1631</span>        }</div>
<div class="line"><span class="lineno"> 1632</span> </div>
<div class="line"><span class="lineno"> 1633</span>        <span class="comment">/* write directory entry to disk */</span></div>
<div class="line"><span class="lineno"> 1634</span>        dir_entry-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8af0bfe59cef4c7940d2e53da87a0c28">entry_offset</a> = dir_entry_offset;</div>
<div class="line"><span class="lineno"> 1635</span>        <span class="keywordflow">if</span>(!<a class="code hl_function" href="group__fat16__fs.html#gaa8e109c4e412a52e117f01aab14831c9">fat16_write_dir_entry</a>(fs, dir_entry))</div>
<div class="line"><span class="lineno"> 1636</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1637</span>    </div>
<div class="line"><span class="lineno"> 1638</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 1639</span>    </div>
<div class="line"><span class="lineno"> 1640</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno"> 1641</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1642</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 1643</span>}</div>
<div class="ttc" id="afat16_8h_html_a062d60991f5236f2dd1b323d7faeabe3"><div class="ttname"><a href="fat16_8h.html#a062d60991f5236f2dd1b323d7faeabe3">FAT16_DIRENTRY_DELETED</a></div><div class="ttdeci">#define FAT16_DIRENTRY_DELETED</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l00072">fat16.h:72</a></div></div>
<div class="ttc" id="agroup__fat16__dir_html_ga73c8f0598e8224736b09644c48cf2970"><div class="ttname"><a href="group__fat16__dir.html#ga73c8f0598e8224736b09644c48cf2970">fat16_read_dir</a></div><div class="ttdeci">uint8_t fat16_read_dir(struct fat16_dir_struct *dd, struct fat16_dir_entry_struct *dir_entry)</div><div class="ttdoc">Reads the next directory entry contained within a parent directory.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l01249">fat16.h:1249</a></div></div>
<div class="ttc" id="agroup__fat16__dir_html_gaaed63addc9b9a3d5137f3b552abb42d8"><div class="ttname"><a href="group__fat16__dir.html#gaaed63addc9b9a3d5137f3b552abb42d8">fat16_reset_dir</a></div><div class="ttdeci">uint8_t fat16_reset_dir(struct fat16_dir_struct *dd)</div><div class="ttdoc">Resets a directory handle.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l01290">fat16.h:1290</a></div></div>
<div class="ttc" id="agroup__fat16__fs_html_ga7c2bf1884a5d396916b4581e15eb6992"><div class="ttname"><a href="group__fat16__fs.html#ga7c2bf1884a5d396916b4581e15eb6992">fat16_append_clusters</a></div><div class="ttdeci">static uint16_t fat16_append_clusters(const struct fat16_fs_struct *fs, uint16_t cluster_num, uint16_t count)</div><div class="ttdoc">Appends a new cluster chain to an existing one.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l00601">fat16.h:601</a></div></div>
<div class="ttc" id="agroup__fat16__fs_html_ga80d15e5b202d3b8999f1c05d5da6be6a"><div class="ttname"><a href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a">fat16_get_next_cluster</a></div><div class="ttdeci">static uint16_t fat16_get_next_cluster(const struct fat16_fs_struct *fs, uint16_t cluster_num)</div><div class="ttdoc">Retrieves the next following cluster of a given cluster.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l00566">fat16.h:566</a></div></div>
<div class="ttc" id="agroup__fat16__fs_html_gaa8e109c4e412a52e117f01aab14831c9"><div class="ttname"><a href="group__fat16__fs.html#gaa8e109c4e412a52e117f01aab14831c9">fat16_write_dir_entry</a></div><div class="ttdeci">static uint8_t fat16_write_dir_entry(const struct fat16_fs_struct *fs, const struct fat16_dir_entry_struct *dir_entry)</div><div class="ttdoc">Writes a directory entry to disk.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l01327">fat16.h:1327</a></div></div>
<div class="ttc" id="astructfat16__dir__entry__struct_html_a8af0bfe59cef4c7940d2e53da87a0c28"><div class="ttname"><a href="structfat16__dir__entry__struct.html#a8af0bfe59cef4c7940d2e53da87a0c28">fat16_dir_entry_struct::entry_offset</a></div><div class="ttdeci">uint32_t entry_offset</div><div class="ttdoc">The total disk offset of this directory entry.</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00081">fat16_header.h:81</a></div></div>
<div class="ttc" id="astructfat16__dir__entry__struct_html_a8bbd1a1339bd035f916ffe91420cc8ad"><div class="ttname"><a href="structfat16__dir__entry__struct.html#a8bbd1a1339bd035f916ffe91420cc8ad">fat16_dir_entry_struct::cluster</a></div><div class="ttdeci">uint16_t cluster</div><div class="ttdoc">The time the file was last modified.</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00077">fat16_header.h:77</a></div></div>
<div class="ttc" id="astructfat16__dir__entry__struct_html_a9f625c7e8ac92bd268c62089f71480d0"><div class="ttname"><a href="structfat16__dir__entry__struct.html#a9f625c7e8ac92bd268c62089f71480d0">fat16_dir_entry_struct::long_name</a></div><div class="ttdeci">char long_name[32]</div><div class="ttdoc">The file's name, truncated to 31 characters.</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00067">fat16_header.h:67</a></div></div>
<div class="ttc" id="astructfat16__dir__struct_html_a3e931a086f03c316195e59541679db6b"><div class="ttname"><a href="structfat16__dir__struct.html#a3e931a086f03c316195e59541679db6b">fat16_dir_struct::fs</a></div><div class="ttdeci">struct fat16_fs_struct * fs</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00165">fat16_header.h:165</a></div></div>
<div class="ttc" id="astructfat16__dir__struct_html_a5549da6db7a16c0a5c6b2016cf0826d6"><div class="ttname"><a href="structfat16__dir__struct.html#a5549da6db7a16c0a5c6b2016cf0826d6">fat16_dir_struct::dir_entry</a></div><div class="ttdeci">struct fat16_dir_entry_struct dir_entry</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00166">fat16_header.h:166</a></div></div>
<div class="ttc" id="astructfat16__fs__struct_html"><div class="ttname"><a href="structfat16__fs__struct.html">fat16_fs_struct</a></div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00151">fat16_header.h:151</a></div></div>
<div class="ttc" id="astructfat16__fs__struct_html_a59ba2a9a21fc39f90358fe48baa5b923"><div class="ttname"><a href="structfat16__fs__struct.html#a59ba2a9a21fc39f90358fe48baa5b923">fat16_fs_struct::partition</a></div><div class="ttdeci">struct partition_struct * partition</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00152">fat16_header.h:152</a></div></div>
<div class="ttc" id="astructfat16__fs__struct_html_ad1287906321608dc2aa7741324dca9b5"><div class="ttname"><a href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">fat16_fs_struct::header</a></div><div class="ttdeci">struct fat16_header_struct header</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00153">fat16_header.h:153</a></div></div>
<div class="ttc" id="astructfat16__header__struct_html_a1e631311b2e65eef7f022196ec16aa18"><div class="ttname"><a href="structfat16__header__struct.html#a1e631311b2e65eef7f022196ec16aa18">fat16_header_struct::root_dir_offset</a></div><div class="ttdeci">uint32_t root_dir_offset</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00146">fat16_header.h:146</a></div></div>
<div class="ttc" id="astructfat16__header__struct_html_a724086964a23748a0585386c396b945e"><div class="ttname"><a href="structfat16__header__struct.html#a724086964a23748a0585386c396b945e">fat16_header_struct::cluster_size</a></div><div class="ttdeci">uint16_t cluster_size</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00144">fat16_header.h:144</a></div></div>
<div class="ttc" id="astructfat16__header__struct_html_a877f23793a9b6cf783f71bf31fb18bb1"><div class="ttname"><a href="structfat16__header__struct.html#a877f23793a9b6cf783f71bf31fb18bb1">fat16_header_struct::cluster_zero_offset</a></div><div class="ttdeci">uint32_t cluster_zero_offset</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00148">fat16_header.h:148</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_gaf8029e3ec633902d08e8204d13afc350_cgraph.png" border="0" usemap="#agroup__fat16_gaf8029e3ec633902d08e8204d13afc350_cgraph" alt=""/></div>
<map name="agroup__fat16_gaf8029e3ec633902d08e8204d13afc350_cgraph" id="agroup__fat16_gaf8029e3ec633902d08e8204d13afc350_cgraph">
<area shape="rect" title="Creates a file." alt="" coords="5,111,121,137"/>
<area shape="rect" href="group__fat16__fs.html#ga7c2bf1884a5d396916b4581e15eb6992" title="Appends a new cluster chain to an existing one." alt="" coords="169,5,320,32"/>
<area shape="poly" title=" " alt="" coords="80,108,119,79,167,48,192,36,194,41,170,53,122,83,83,112"/>
<area shape="rect" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a" title="Retrieves the next following cluster of a given cluster." alt="" coords="547,56,700,83"/>
<area shape="poly" title=" " alt="" coords="113,107,168,96,265,84,363,76,532,68,532,73,363,81,266,89,169,101,114,113"/>
<area shape="rect" href="group__fat16__dir.html#ga73c8f0598e8224736b09644c48cf2970" title="Reads the next directory entry contained within a parent directory." alt="" coords="193,111,296,137"/>
<area shape="poly" title=" " alt="" coords="121,121,178,121,178,127,121,127"/>
<area shape="rect" href="group__fat16__dir.html#gaaed63addc9b9a3d5137f3b552abb42d8" title="Resets a directory handle." alt="" coords="191,161,298,188"/>
<area shape="poly" title=" " alt="" coords="114,135,180,154,179,159,113,141"/>
<area shape="rect" href="group__fat16__fs.html#gaa8e109c4e412a52e117f01aab14831c9" title="Writes a directory entry to disk." alt="" coords="174,212,315,239"/>
<area shape="poly" title=" " alt="" coords="82,136,120,166,170,198,182,204,180,208,167,202,117,171,78,140"/>
<area shape="rect" href="group__fat16__fs.html#gadef154e10fea9a769262e22c4bbfa383" title="Frees a cluster chain, or a part thereof." alt="" coords="369,5,499,32"/>
<area shape="poly" title=" " alt="" coords="321,16,353,16,353,21,321,21"/>
<area shape="rect" href="group__fat16__fs.html#ga2e0cd2d601f164cec718052204d257b5" title="Reads a directory entry of the root directory." alt="" coords="368,173,499,216"/>
<area shape="poly" title=" " alt="" coords="289,135,321,147,367,165,365,170,319,152,287,140"/>
<area shape="rect" href="group__fat16__fs.html#gaefed7787ed7c6e2ce35f67c06aac36c7" title="Reads a directory entry of a given parent directory." alt="" coords="369,107,499,149"/>
<area shape="poly" title=" " alt="" coords="296,122,353,124,353,129,296,128"/>
<area shape="rect" href="group__fat16__fs.html#ga64666f9e44e49273d33ed01058ff5fac" title="Callback function for reading a directory entry." alt="" coords="554,173,693,216"/>
<area shape="poly" title=" " alt="" coords="500,192,539,192,539,197,500,197"/>
<area shape="rect" href="group__fat16__fs.html#ga6f277c11fa202ecfadca3635221f70a4" title="Callback function for seeking through subdirectory entries." alt="" coords="553,107,694,149"/>
<area shape="poly" title=" " alt="" coords="495,170,545,152,547,158,497,175"/>
<area shape="rect" href="group__fat16__fs.html#ga8927d70d35df0d10284286e2d5b66193" title="Interprets a raw directory entry and puts the contained information into the directory entry." alt="" coords="748,173,872,216"/>
<area shape="poly" title=" " alt="" coords="693,192,732,192,732,197,693,197"/>
<area shape="poly" title=" " alt="" coords="499,105,563,85,564,90,500,110"/>
<area shape="poly" title=" " alt="" coords="497,147,547,165,545,170,495,152"/>
<area shape="poly" title=" " alt="" coords="499,125,537,125,537,131,499,131"/>
</map>
</div>

</div>
</div>
<a id="gae060faccbbeca802afe86be2f4d5b485" name="gae060faccbbeca802afe86be2f4d5b485"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae060faccbbeca802afe86be2f4d5b485">&#9670;&#160;</a></span>fat16_delete_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t fat16_delete_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dir_entry</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes a file or directory. </p>
<p>It is not checked if the file to delete is a directory. If a directory is deleted without first deleting its subdirectories and files, disk space occupied by these files will get wasted as there is no chance to release it and mark it as free.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The filesystem on which to operate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dir_entry</td><td>The directory entry of the file to delete. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on failure, 1 on success. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__file.html#gaf8029e3ec633902d08e8204d13afc350" title="Creates a file.">fat16_create_file</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01660">1660</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1661</span>{</div>
<div class="line"><span class="lineno"> 1662</span><span class="preprocessor">    #if FAT16_WRITE_SUPPORT</span></div>
<div class="line"><span class="lineno"> 1663</span>        <span class="keywordflow">if</span>(!fs || !dir_entry)</div>
<div class="line"><span class="lineno"> 1664</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1665</span>    </div>
<div class="line"><span class="lineno"> 1666</span>        <span class="comment">/* get offset of the file&#39;s directory entry */</span></div>
<div class="line"><span class="lineno"> 1667</span>        uint32_t dir_entry_offset = dir_entry-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8af0bfe59cef4c7940d2e53da87a0c28">entry_offset</a>;</div>
<div class="line"><span class="lineno"> 1668</span>        <span class="keywordflow">if</span>(!dir_entry_offset)</div>
<div class="line"><span class="lineno"> 1669</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1670</span>    </div>
<div class="line"><span class="lineno"> 1671</span>        uint8_t buffer[12];</div>
<div class="line"><span class="lineno"> 1672</span>        <span class="keywordflow">while</span>(1)</div>
<div class="line"><span class="lineno"> 1673</span>        {</div>
<div class="line"><span class="lineno"> 1674</span>            <span class="comment">/* read directory entry */</span></div>
<div class="line"><span class="lineno"> 1675</span>            <span class="keywordflow">if</span>(!fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#a59ba2a9a21fc39f90358fe48baa5b923">partition</a>-&gt;device_read(dir_entry_offset, buffer, <span class="keyword">sizeof</span>(buffer)))</div>
<div class="line"><span class="lineno"> 1676</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1677</span>    </div>
<div class="line"><span class="lineno"> 1678</span>            <span class="comment">/* mark the directory entry as deleted */</span></div>
<div class="line"><span class="lineno"> 1679</span>            buffer[0] = <a class="code hl_define" href="fat16_8h.html#a062d60991f5236f2dd1b323d7faeabe3">FAT16_DIRENTRY_DELETED</a>;</div>
<div class="line"><span class="lineno"> 1680</span>    </div>
<div class="line"><span class="lineno"> 1681</span>            <span class="comment">/* write back entry */</span></div>
<div class="line"><span class="lineno"> 1682</span>            <span class="keywordflow">if</span>(!fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#a59ba2a9a21fc39f90358fe48baa5b923">partition</a>-&gt;device_write(dir_entry_offset, buffer, <span class="keyword">sizeof</span>(buffer)))</div>
<div class="line"><span class="lineno"> 1683</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1684</span>    </div>
<div class="line"><span class="lineno"> 1685</span>            <span class="comment">/* check if we deleted the whole entry */</span></div>
<div class="line"><span class="lineno"> 1686</span>            <span class="keywordflow">if</span>(buffer[11] != 0x0f)</div>
<div class="line"><span class="lineno"> 1687</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1688</span>    </div>
<div class="line"><span class="lineno"> 1689</span>            dir_entry_offset += 32;</div>
<div class="line"><span class="lineno"> 1690</span>        }</div>
<div class="line"><span class="lineno"> 1691</span>    </div>
<div class="line"><span class="lineno"> 1692</span>        <span class="comment">/* We deleted the directory entry. The next thing to do is</span></div>
<div class="line"><span class="lineno"> 1693</span><span class="comment">                             * marking all occupied clusters as free.</span></div>
<div class="line"><span class="lineno"> 1694</span><span class="comment">                             */</span></div>
<div class="line"><span class="lineno"> 1695</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="group__fat16__fs.html#gadef154e10fea9a769262e22c4bbfa383">fat16_free_clusters</a>(fs, dir_entry-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8bbd1a1339bd035f916ffe91420cc8ad">cluster</a>);</div>
<div class="line"><span class="lineno"> 1696</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno"> 1697</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1698</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 1699</span>}</div>
<div class="ttc" id="agroup__fat16__fs_html_gadef154e10fea9a769262e22c4bbfa383"><div class="ttname"><a href="group__fat16__fs.html#gadef154e10fea9a769262e22c4bbfa383">fat16_free_clusters</a></div><div class="ttdeci">static uint8_t fat16_free_clusters(const struct fat16_fs_struct *fs, uint16_t cluster_num)</div><div class="ttdoc">Frees a cluster chain, or a part thereof.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l00694">fat16.h:694</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_gae060faccbbeca802afe86be2f4d5b485_cgraph.png" border="0" usemap="#agroup__fat16_gae060faccbbeca802afe86be2f4d5b485_cgraph" alt=""/></div>
<map name="agroup__fat16_gae060faccbbeca802afe86be2f4d5b485_cgraph" id="agroup__fat16_gae060faccbbeca802afe86be2f4d5b485_cgraph">
<area shape="rect" title="Deletes a file or directory." alt="" coords="5,5,120,32"/>
<area shape="rect" href="group__fat16__fs.html#gadef154e10fea9a769262e22c4bbfa383" title="Frees a cluster chain, or a part thereof." alt="" coords="168,5,298,32"/>
<area shape="poly" title=" " alt="" coords="120,16,152,16,152,21,120,21"/>
</map>
</div>

</div>
</div>
<a id="ga3e2318395c5e0c965a48adecb9c20196" name="ga3e2318395c5e0c965a48adecb9c20196"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3e2318395c5e0c965a48adecb9c20196">&#9670;&#160;</a></span>fat16_file_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fat16_file_size </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>file</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01801">1801</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1802</span>{</div>
<div class="line"><span class="lineno"> 1803</span>    <span class="keywordflow">return</span>(file-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a20dc3151ca3727aef4ad79a7735131ff">file_size</a>);</div>
<div class="line"><span class="lineno"> 1804</span>}</div>
<div class="ttc" id="astructfat16__dir__entry__struct_html_a20dc3151ca3727aef4ad79a7735131ff"><div class="ttname"><a href="structfat16__dir__entry__struct.html#a20dc3151ca3727aef4ad79a7735131ff">fat16_dir_entry_struct::file_size</a></div><div class="ttdeci">uint32_t file_size</div><div class="ttdoc">The file's size.</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00079">fat16_header.h:79</a></div></div>
<div class="ttc" id="astructfat16__file__struct_html_a1084cb148b29e32a97713c2476b8a159"><div class="ttname"><a href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">fat16_file_struct::dir_entry</a></div><div class="ttdeci">struct fat16_dir_entry_struct dir_entry</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00159">fat16_header.h:159</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga0045fe378de2f7c52b528f985e1891a6" name="ga0045fe378de2f7c52b528f985e1891a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0045fe378de2f7c52b528f985e1891a6">&#9670;&#160;</a></span>fat16_get_dir_entry_of_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t fat16_get_dir_entry_of_path </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dir_entry</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the directory entry of a path. </p>
<p>The given path may both describe a file or a directory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The FAT16 filesystem on which to search. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>The path of which to read the directory entry. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dir_entry</td><td>The directory entry to fill. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on failure, 1 on success. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__dir.html#ga73c8f0598e8224736b09644c48cf2970" title="Reads the next directory entry contained within a parent directory.">fat16_read_dir</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l00499">499</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  500</span>{</div>
<div class="line"><span class="lineno">  501</span>    <span class="keywordflow">if</span>(!fs || !path || path[0] == <span class="charliteral">&#39;\0&#39;</span> || !dir_entry)</div>
<div class="line"><span class="lineno">  502</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>    <span class="keywordflow">if</span>(path[0] == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><span class="lineno">  505</span>        ++path;</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>    <span class="comment">/* begin with the root directory */</span></div>
<div class="line"><span class="lineno">  508</span>    memset(dir_entry, 0, <span class="keyword">sizeof</span>(*dir_entry));</div>
<div class="line"><span class="lineno">  509</span>    dir_entry-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a4e4c6084a1f0cf1e687ac68853dbd61e">attributes</a> = <a class="code hl_define" href="group__fat16__file.html#gaafdb0e859960ff33b11b6c55b3188274">FAT16_ATTRIB_DIR</a>;</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span>    <span class="keywordflow">if</span>(path[0] == <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">while</span>(1) {</div>
<div class="line"><span class="lineno">  515</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structfat16__dir__struct.html">fat16_dir_struct</a> dd;</div>
<div class="line"><span class="lineno">  516</span>        <span class="keywordtype">int</span> result=<a class="code hl_function" href="group__fat16__dir.html#ga61fa0c22ba72801630b6472f87f7f9d7">fat16_open_dir</a>(&amp;dd, <a class="code hl_variable" href="structfat16__dir__struct.html#a3e931a086f03c316195e59541679db6b">fs</a>, <a class="code hl_variable" href="structfat16__dir__struct.html#a5549da6db7a16c0a5c6b2016cf0826d6">dir_entry</a>);</div>
<div class="line"><span class="lineno">  517</span>        <span class="keywordflow">if</span>(result&lt;0) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>        <span class="comment">/* extract the next hierarchy we will search for */</span></div>
<div class="line"><span class="lineno">  520</span>        <span class="keyword">const</span> <span class="keywordtype">char</span>* sep_pos = strchr(path, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  521</span>        <span class="keywordflow">if</span>(!sep_pos)</div>
<div class="line"><span class="lineno">  522</span>            sep_pos = path + strlen(path);</div>
<div class="line"><span class="lineno">  523</span>        uint8_t length_to_sep = sep_pos - path;</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>        <span class="comment">/* read directory entries */</span></div>
<div class="line"><span class="lineno">  526</span>        <span class="keywordflow">while</span>(<a class="code hl_function" href="group__fat16__dir.html#ga73c8f0598e8224736b09644c48cf2970">fat16_read_dir</a>(&amp;dd, <a class="code hl_variable" href="structfat16__dir__struct.html#a5549da6db7a16c0a5c6b2016cf0826d6">dir_entry</a>)) {</div>
<div class="line"><span class="lineno">  527</span>            <span class="comment">/* check if we have found the next hierarchy */</span></div>
<div class="line"><span class="lineno">  528</span>            <span class="keywordflow">if</span>((strlen(<a class="code hl_variable" href="structfat16__dir__struct.html#a5549da6db7a16c0a5c6b2016cf0826d6">dir_entry</a>-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a9f625c7e8ac92bd268c62089f71480d0">long_name</a>) != length_to_sep ||</div>
<div class="line"><span class="lineno">  529</span>                strncmp(path, <a class="code hl_variable" href="structfat16__dir__struct.html#a5549da6db7a16c0a5c6b2016cf0826d6">dir_entry</a>-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a9f625c7e8ac92bd268c62089f71480d0">long_name</a>, length_to_sep) != 0))</div>
<div class="line"><span class="lineno">  530</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>            <a class="code hl_function" href="group__fat16__dir.html#ga95f491a5a0b6438781aefaedc250e926">fat16_close_dir</a>(&amp;dd);</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>            <span class="keywordflow">if</span>(path[length_to_sep] == <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno">  535</span>    <span class="comment">/* we iterated through the whole path and have found the file */</span></div>
<div class="line"><span class="lineno">  536</span>                <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="structfat16__dir__struct.html#a5549da6db7a16c0a5c6b2016cf0826d6">dir_entry</a>-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a4e4c6084a1f0cf1e687ac68853dbd61e">attributes</a> &amp; <a class="code hl_define" href="group__fat16__file.html#gaafdb0e859960ff33b11b6c55b3188274">FAT16_ATTRIB_DIR</a>) {</div>
<div class="line"><span class="lineno">  539</span>                <span class="comment">/* we found a parent directory of the file we are searching for */</span></div>
<div class="line"><span class="lineno">  540</span>                path = sep_pos + 1;</div>
<div class="line"><span class="lineno">  541</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  542</span>            }</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>            <span class="comment">/* a parent of the file exists, but not the file itself */</span></div>
<div class="line"><span class="lineno">  545</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  546</span>        }</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>        <a class="code hl_function" href="group__fat16__dir.html#ga95f491a5a0b6438781aefaedc250e926">fat16_close_dir</a>(&amp;dd);</div>
<div class="line"><span class="lineno">  549</span>    }</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  552</span>}</div>
<div class="ttc" id="agroup__fat16__dir_html_ga61fa0c22ba72801630b6472f87f7f9d7"><div class="ttname"><a href="group__fat16__dir.html#ga61fa0c22ba72801630b6472f87f7f9d7">fat16_open_dir</a></div><div class="ttdeci">int fat16_open_dir(struct fat16_dir_struct *dd, struct fat16_fs_struct *fs, const struct fat16_dir_entry_struct *dir_entry)</div><div class="ttdoc">Opens a directory.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l01210">fat16.h:1210</a></div></div>
<div class="ttc" id="agroup__fat16__dir_html_ga95f491a5a0b6438781aefaedc250e926"><div class="ttname"><a href="group__fat16__dir.html#ga95f491a5a0b6438781aefaedc250e926">fat16_close_dir</a></div><div class="ttdeci">void fat16_close_dir(struct fat16_dir_struct *dd)</div><div class="ttdoc">Closes a directory descriptor.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l01236">fat16.h:1236</a></div></div>
<div class="ttc" id="agroup__fat16__file_html_gaafdb0e859960ff33b11b6c55b3188274"><div class="ttname"><a href="group__fat16__file.html#gaafdb0e859960ff33b11b6c55b3188274">FAT16_ATTRIB_DIR</a></div><div class="ttdeci">#define FAT16_ATTRIB_DIR</div><div class="ttdoc">The file is a directory.</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00041">fat16_header.h:41</a></div></div>
<div class="ttc" id="astructfat16__dir__entry__struct_html_a4e4c6084a1f0cf1e687ac68853dbd61e"><div class="ttname"><a href="structfat16__dir__entry__struct.html#a4e4c6084a1f0cf1e687ac68853dbd61e">fat16_dir_entry_struct::attributes</a></div><div class="ttdeci">uint8_t attributes</div><div class="ttdoc">The file's attributes.</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00069">fat16_header.h:69</a></div></div>
<div class="ttc" id="astructfat16__dir__struct_html"><div class="ttname"><a href="structfat16__dir__struct.html">fat16_dir_struct</a></div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00164">fat16_header.h:164</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_ga0045fe378de2f7c52b528f985e1891a6_cgraph.png" border="0" usemap="#agroup__fat16_ga0045fe378de2f7c52b528f985e1891a6_cgraph" alt=""/></div>
<map name="agroup__fat16_ga0045fe378de2f7c52b528f985e1891a6_cgraph" id="agroup__fat16_ga0045fe378de2f7c52b528f985e1891a6_cgraph">
<area shape="rect" title="Retrieves the directory entry of a path." alt="" coords="5,48,137,91"/>
<area shape="rect" href="group__fat16__dir.html#ga95f491a5a0b6438781aefaedc250e926" title="Closes a directory descriptor." alt="" coords="185,5,293,32"/>
<area shape="poly" title=" " alt="" coords="136,47,177,34,179,40,138,52"/>
<area shape="rect" href="group__fat16__dir.html#ga61fa0c22ba72801630b6472f87f7f9d7" title="Opens a directory." alt="" coords="186,56,292,83"/>
<area shape="poly" title=" " alt="" coords="137,67,170,67,170,72,137,72"/>
<area shape="rect" href="group__fat16__dir.html#ga73c8f0598e8224736b09644c48cf2970" title="Reads the next directory entry contained within a parent directory." alt="" coords="188,107,290,133"/>
<area shape="poly" title=" " alt="" coords="138,87,179,99,177,104,136,92"/>
<area shape="rect" href="group__fat16__fs.html#ga2e0cd2d601f164cec718052204d257b5" title="Reads a directory entry of the root directory." alt="" coords="341,65,472,108"/>
<area shape="poly" title=" " alt="" coords="290,107,325,100,326,105,291,112"/>
<area shape="rect" href="group__fat16__fs.html#gaefed7787ed7c6e2ce35f67c06aac36c7" title="Reads a directory entry of a given parent directory." alt="" coords="342,132,472,175"/>
<area shape="poly" title=" " alt="" coords="291,128,327,135,326,140,290,133"/>
<area shape="rect" href="group__fat16__fs.html#ga64666f9e44e49273d33ed01058ff5fac" title="Callback function for reading a directory entry." alt="" coords="527,132,666,175"/>
<area shape="poly" title=" " alt="" coords="470,106,520,124,518,129,468,111"/>
<area shape="rect" href="group__fat16__fs.html#ga6f277c11fa202ecfadca3635221f70a4" title="Callback function for seeking through subdirectory entries." alt="" coords="526,65,667,108"/>
<area shape="poly" title=" " alt="" coords="473,84,510,84,510,89,473,89"/>
<area shape="rect" href="group__fat16__fs.html#ga8927d70d35df0d10284286e2d5b66193" title="Interprets a raw directory entry and puts the contained information into the directory entry." alt="" coords="721,132,845,175"/>
<area shape="poly" title=" " alt="" coords="666,151,705,151,705,156,666,156"/>
<area shape="poly" title=" " alt="" coords="472,151,512,151,512,156,472,156"/>
<area shape="poly" title=" " alt="" coords="468,129,518,111,520,116,470,134"/>
<area shape="rect" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a" title="Retrieves the next following cluster of a given cluster." alt="" coords="520,199,673,225"/>
<area shape="poly" title=" " alt="" coords="473,171,537,191,536,196,472,176"/>
</map>
</div>

</div>
</div>
<a id="ga2f8ff07cca44ecb6770b12a58b6cd8c7" name="ga2f8ff07cca44ecb6770b12a58b6cd8c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2f8ff07cca44ecb6770b12a58b6cd8c7">&#9670;&#160;</a></span>fat16_get_fs_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t fat16_get_fs_free </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the amount of free storage capacity on the filesystem in bytes. </p>
<dl class="section note"><dt>Note</dt><dd>As the FAT16 filesystem is cluster based, this function does not return continuous values but multiples of the cluster size.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The filesystem on which to operate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on failure, the free filesystem space in bytes otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01726">1726</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1727</span>{</div>
<div class="line"><span class="lineno"> 1728</span>    <span class="keywordflow">if</span>(!fs)</div>
<div class="line"><span class="lineno"> 1729</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1730</span> </div>
<div class="line"><span class="lineno"> 1731</span>    uint8_t fat[32];</div>
<div class="line"><span class="lineno"> 1732</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structfat16__usage__count__callback__arg.html">fat16_usage_count_callback_arg</a> count_arg;</div>
<div class="line"><span class="lineno"> 1733</span>    count_arg.<a class="code hl_variable" href="structfat16__usage__count__callback__arg.html#a78692e17dfc842a4b944a25536eef604">cluster_count</a> = 0;</div>
<div class="line"><span class="lineno"> 1734</span>    count_arg.buffer_size = <span class="keyword">sizeof</span>(fat);</div>
<div class="line"><span class="lineno"> 1735</span> </div>
<div class="line"><span class="lineno"> 1736</span>    uint32_t fat_offset = fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a747d84164b4dc1f39c8081dc6f59432a">fat_offset</a>;</div>
<div class="line"><span class="lineno"> 1737</span>    uint32_t fat_size = fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#ad96d9b98bad8bd19d767857f8bfe1870">fat_size</a>;</div>
<div class="line"><span class="lineno"> 1738</span>    <span class="keywordflow">while</span>(fat_size &gt; 0) {</div>
<div class="line"><span class="lineno"> 1739</span>        uint16_t length = UINT16_MAX - 1;</div>
<div class="line"><span class="lineno"> 1740</span>        <span class="keywordflow">if</span>(fat_size &lt; length)</div>
<div class="line"><span class="lineno"> 1741</span>            length = fat_size;</div>
<div class="line"><span class="lineno"> 1742</span> </div>
<div class="line"><span class="lineno"> 1743</span>        <span class="keywordflow">if</span>(!fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#a59ba2a9a21fc39f90358fe48baa5b923">partition</a>-&gt;device_read_interval(fat_offset,</div>
<div class="line"><span class="lineno"> 1744</span>            fat,</div>
<div class="line"><span class="lineno"> 1745</span>           <span class="keyword">sizeof</span>(fat),</div>
<div class="line"><span class="lineno"> 1746</span>           length,</div>
<div class="line"><span class="lineno"> 1747</span>           <a class="code hl_function" href="group__fat16__fs.html#ga7b21ea41c37e54f4edf690918f92fe8a">fat16_get_fs_free_callback</a>,</div>
<div class="line"><span class="lineno"> 1748</span>           &amp;count_arg</div>
<div class="line"><span class="lineno"> 1749</span>           )</div>
<div class="line"><span class="lineno"> 1750</span>           )</div>
<div class="line"><span class="lineno"> 1751</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1752</span> </div>
<div class="line"><span class="lineno"> 1753</span>        fat_offset += length;</div>
<div class="line"><span class="lineno"> 1754</span>        fat_size -= length;</div>
<div class="line"><span class="lineno"> 1755</span>    }</div>
<div class="line"><span class="lineno"> 1756</span> </div>
<div class="line"><span class="lineno"> 1757</span>    <span class="keywordflow">return</span> (uint32_t) count_arg.cluster_count * fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a724086964a23748a0585386c396b945e">cluster_size</a>;</div>
<div class="line"><span class="lineno"> 1758</span>}</div>
<div class="ttc" id="agroup__fat16__fs_html_ga7b21ea41c37e54f4edf690918f92fe8a"><div class="ttname"><a href="group__fat16__fs.html#ga7b21ea41c37e54f4edf690918f92fe8a">fat16_get_fs_free_callback</a></div><div class="ttdeci">static uint8_t fat16_get_fs_free_callback(uint8_t *buffer, uint32_t offset, void *p)</div><div class="ttdoc">Callback function used for counting free clusters.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l01764">fat16.h:1764</a></div></div>
<div class="ttc" id="astructfat16__header__struct_html_a747d84164b4dc1f39c8081dc6f59432a"><div class="ttname"><a href="structfat16__header__struct.html#a747d84164b4dc1f39c8081dc6f59432a">fat16_header_struct::fat_offset</a></div><div class="ttdeci">uint32_t fat_offset</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00140">fat16_header.h:140</a></div></div>
<div class="ttc" id="astructfat16__header__struct_html_ad96d9b98bad8bd19d767857f8bfe1870"><div class="ttname"><a href="structfat16__header__struct.html#ad96d9b98bad8bd19d767857f8bfe1870">fat16_header_struct::fat_size</a></div><div class="ttdeci">uint32_t fat_size</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00141">fat16_header.h:141</a></div></div>
<div class="ttc" id="astructfat16__usage__count__callback__arg_html"><div class="ttname"><a href="structfat16__usage__count__callback__arg.html">fat16_usage_count_callback_arg</a></div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00177">fat16_header.h:177</a></div></div>
<div class="ttc" id="astructfat16__usage__count__callback__arg_html_a78692e17dfc842a4b944a25536eef604"><div class="ttname"><a href="structfat16__usage__count__callback__arg.html#a78692e17dfc842a4b944a25536eef604">fat16_usage_count_callback_arg::cluster_count</a></div><div class="ttdeci">uint16_t cluster_count</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00178">fat16_header.h:178</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_ga2f8ff07cca44ecb6770b12a58b6cd8c7_cgraph.png" border="0" usemap="#agroup__fat16_ga2f8ff07cca44ecb6770b12a58b6cd8c7_cgraph" alt=""/></div>
<map name="agroup__fat16_ga2f8ff07cca44ecb6770b12a58b6cd8c7_cgraph" id="agroup__fat16_ga2f8ff07cca44ecb6770b12a58b6cd8c7_cgraph">
<area shape="rect" title="Returns the amount of free storage capacity on the filesystem in bytes." alt="" coords="5,5,125,32"/>
<area shape="rect" href="group__fat16__fs.html#ga7b21ea41c37e54f4edf690918f92fe8a" title="Callback function used for counting free clusters." alt="" coords="173,5,347,32"/>
<area shape="poly" title=" " alt="" coords="125,16,157,16,157,21,125,21"/>
</map>
</div>

</div>
</div>
<a id="ga8af3c3535929e19b0039e07f1976cec7" name="ga8af3c3535929e19b0039e07f1976cec7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8af3c3535929e19b0039e07f1976cec7">&#9670;&#160;</a></span>fat16_get_fs_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t fat16_get_fs_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the amount of total storage capacity of the filesystem in bytes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The filesystem on which to operate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on failure, the filesystem size in bytes otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01708">1708</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1709</span>{</div>
<div class="line"><span class="lineno"> 1710</span>    <span class="keywordflow">if</span>(!fs)</div>
<div class="line"><span class="lineno"> 1711</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1712</span> </div>
<div class="line"><span class="lineno"> 1713</span>    <span class="keywordflow">return</span> (fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#ad96d9b98bad8bd19d767857f8bfe1870">fat_size</a> / 2 - 2) * fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a724086964a23748a0585386c396b945e">cluster_size</a>;</div>
<div class="line"><span class="lineno"> 1714</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga554cb707673a9db9d6a668af97600d04" name="ga554cb707673a9db9d6a668af97600d04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga554cb707673a9db9d6a668af97600d04">&#9670;&#160;</a></span>fat16_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fat16_open </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct partition_struct *</td>          <td class="paramname"><span class="paramname"><em>partition</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens a FAT16 filesystem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">partition</td><td>Discriptor of partition on which the filesystem resides. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on error, a FAT16 filesystem descriptor on success. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__fs.html#ga554cb707673a9db9d6a668af97600d04" title="Opens a FAT16 filesystem.">fat16_open</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l00098">98</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   98</span>                                                                               {</div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">if</span>(!partition ||</div>
<div class="line"><span class="lineno">  100</span>        #<span class="keywordflow">if</span> FAT16_WRITE_SUPPORT</div>
<div class="line"><span class="lineno">  101</span>        !partition-&gt;device_write</div>
<div class="line"><span class="lineno">  102</span>       #<span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  103</span>        0</div>
<div class="line"><span class="lineno">  104</span>       #endif</div>
<div class="line"><span class="lineno">  105</span>       )</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">if</span>(!fs) <span class="keywordflow">return</span> -2;</div>
<div class="line"><span class="lineno">  109</span>    </div>
<div class="line"><span class="lineno">  110</span>    memset(fs, 0, <span class="keyword">sizeof</span>(*fs));</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    fs-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#a59ba2a9a21fc39f90358fe48baa5b923">partition</a> = partition;</div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">if</span>(!<a class="code hl_function" href="group__fat16__fs.html#ga4ae970c89e2d74d71eb313f104db7e27">fat16_read_header</a>(fs)) <span class="keywordflow">return</span> -3;</div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  115</span>}</div>
<div class="ttc" id="agroup__fat16__fs_html_ga4ae970c89e2d74d71eb313f104db7e27"><div class="ttname"><a href="group__fat16__fs.html#ga4ae970c89e2d74d71eb313f104db7e27">fat16_read_header</a></div><div class="ttdeci">static uint8_t fat16_read_header(struct fat16_fs_struct *fs)</div><div class="ttdoc">Reads and parses the header of a FAT16 filesystem.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l00139">fat16.h:139</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_ga554cb707673a9db9d6a668af97600d04_cgraph.png" border="0" usemap="#agroup__fat16_ga554cb707673a9db9d6a668af97600d04_cgraph" alt=""/></div>
<map name="agroup__fat16_ga554cb707673a9db9d6a668af97600d04_cgraph" id="agroup__fat16_ga554cb707673a9db9d6a668af97600d04_cgraph">
<area shape="rect" title="Opens a FAT16 filesystem." alt="" coords="5,5,90,32"/>
<area shape="rect" href="group__fat16__fs.html#ga4ae970c89e2d74d71eb313f104db7e27" title="Reads and parses the header of a FAT16 filesystem." alt="" coords="138,5,265,32"/>
<area shape="poly" title=" " alt="" coords="90,16,122,16,122,21,90,21"/>
</map>
</div>

</div>
</div>
<a id="ga61fa0c22ba72801630b6472f87f7f9d7" name="ga61fa0c22ba72801630b6472f87f7f9d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga61fa0c22ba72801630b6472f87f7f9d7">&#9670;&#160;</a></span>fat16_open_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fat16_open_dir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dir_entry</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens a directory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The filesystem on which the directory to open resides. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dir_entry</td><td>The directory entry which stands for the directory to open. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An opaque directory descriptor on success, 0 on failure. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__dir.html#ga95f491a5a0b6438781aefaedc250e926" title="Closes a directory descriptor.">fat16_close_dir</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01210">1210</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1211</span>{</div>
<div class="line"><span class="lineno"> 1212</span>    <span class="keywordflow">if</span>(!fs || !dir_entry || !(dir_entry-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a4e4c6084a1f0cf1e687ac68853dbd61e">attributes</a> &amp; <a class="code hl_define" href="group__fat16__file.html#gaafdb0e859960ff33b11b6c55b3188274">FAT16_ATTRIB_DIR</a>))</div>
<div class="line"><span class="lineno"> 1213</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>    <span class="keywordflow">if</span>(!dd)</div>
<div class="line"><span class="lineno"> 1216</span>        <span class="keywordflow">return</span> -2;</div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span>    memcpy(&amp;dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#a5549da6db7a16c0a5c6b2016cf0826d6">dir_entry</a>, dir_entry, <span class="keyword">sizeof</span>(*dir_entry));</div>
<div class="line"><span class="lineno"> 1219</span>    dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#a3e931a086f03c316195e59541679db6b">fs</a> = fs;</div>
<div class="line"><span class="lineno"> 1220</span>    dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#ab39a3784ce8e95c38c6d45afa954ab5f">entry_next</a> = 0;</div>
<div class="line"><span class="lineno"> 1221</span> </div>
<div class="line"><span class="lineno"> 1222</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1223</span>}</div>
<div class="ttc" id="astructfat16__dir__struct_html_ab39a3784ce8e95c38c6d45afa954ab5f"><div class="ttname"><a href="structfat16__dir__struct.html#ab39a3784ce8e95c38c6d45afa954ab5f">fat16_dir_struct::entry_next</a></div><div class="ttdeci">uint16_t entry_next</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00167">fat16_header.h:167</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_ga61fa0c22ba72801630b6472f87f7f9d7_icgraph.png" border="0" usemap="#agroup__fat16_ga61fa0c22ba72801630b6472f87f7f9d7_icgraph" alt=""/></div>
<map name="agroup__fat16_ga61fa0c22ba72801630b6472f87f7f9d7_icgraph" id="agroup__fat16_ga61fa0c22ba72801630b6472f87f7f9d7_icgraph">
<area shape="rect" title="Opens a directory." alt="" coords="185,13,290,40"/>
<area shape="rect" href="group__fat16__file.html#ga0045fe378de2f7c52b528f985e1891a6" title="Retrieves the directory entry of a path." alt="" coords="5,5,137,48"/>
<area shape="poly" title=" " alt="" coords="169,29,137,29,137,24,169,24"/>
</map>
</div>

</div>
</div>
<a id="gaa2871189b28d8d45baea4c913b0f8438" name="gaa2871189b28d8d45baea4c913b0f8438"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa2871189b28d8d45baea4c913b0f8438">&#9670;&#160;</a></span>fat16_open_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fat16_open_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dir_entry</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens a file on a FAT16 filesystem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>The filesystem on which the file to open lies. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dir_entry</td><td>The directory entry of the file to open. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The file handle, or 0 on failure. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__file.html#ga2b2812041f489bc7913bfa5cbcf0172b" title="Closes a file.">fat16_close_file</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l00791">791</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  791</span>                                                                                                                              {</div>
<div class="line"><span class="lineno">  792</span>    <span class="keywordflow">if</span>(!fs || !dir_entry || (dir_entry-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a4e4c6084a1f0cf1e687ac68853dbd61e">attributes</a> &amp; <a class="code hl_define" href="group__fat16__file.html#gaafdb0e859960ff33b11b6c55b3188274">FAT16_ATTRIB_DIR</a>))</div>
<div class="line"><span class="lineno">  793</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>    <span class="keywordflow">if</span>(!fd) <span class="keywordflow">return</span> -2;</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>    memcpy(&amp;fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>, dir_entry, <span class="keyword">sizeof</span>(*dir_entry));</div>
<div class="line"><span class="lineno">  798</span>    fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a2e6afeba0fa2950162794e5357d686e8">magic_cookie</a>=<a class="code hl_define" href="fat16_8h.html#a194317b66cbc9cb4f9e897096333026f">FD_MAGIC_COOKIE</a>;</div>
<div class="line"><span class="lineno">  799</span>    fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a> = fs;</div>
<div class="line"><span class="lineno">  800</span>    fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> = 0;</div>
<div class="line"><span class="lineno">  801</span>    fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#acd6b999ba29483b8743b7efe54ddcf3e">pos_cluster</a> = dir_entry-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8bbd1a1339bd035f916ffe91420cc8ad">cluster</a>;</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  804</span>}</div>
<div class="ttc" id="afat16_8h_html_a194317b66cbc9cb4f9e897096333026f"><div class="ttname"><a href="fat16_8h.html#a194317b66cbc9cb4f9e897096333026f">FD_MAGIC_COOKIE</a></div><div class="ttdeci">#define FD_MAGIC_COOKIE</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l00064">fat16.h:64</a></div></div>
<div class="ttc" id="astructfat16__file__struct_html_a214db70a960819544d0c017739949e54"><div class="ttname"><a href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">fat16_file_struct::pos</a></div><div class="ttdeci">uint32_t pos</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00160">fat16_header.h:160</a></div></div>
<div class="ttc" id="astructfat16__file__struct_html_a88b18be69bd3e825f0f0346865b4811b"><div class="ttname"><a href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fat16_file_struct::fs</a></div><div class="ttdeci">struct fat16_fs_struct * fs</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00158">fat16_header.h:158</a></div></div>
<div class="ttc" id="astructfat16__file__struct_html_acd6b999ba29483b8743b7efe54ddcf3e"><div class="ttname"><a href="structfat16__file__struct.html#acd6b999ba29483b8743b7efe54ddcf3e">fat16_file_struct::pos_cluster</a></div><div class="ttdeci">uint16_t pos_cluster</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00161">fat16_header.h:161</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_gaa2871189b28d8d45baea4c913b0f8438_icgraph.png" border="0" usemap="#agroup__fat16_gaa2871189b28d8d45baea4c913b0f8438_icgraph" alt=""/></div>
<map name="agroup__fat16_gaa2871189b28d8d45baea4c913b0f8438_icgraph" id="agroup__fat16_gaa2871189b28d8d45baea4c913b0f8438_icgraph">
<area shape="rect" title="Opens a file on a FAT16 filesystem." alt="" coords="164,5,271,32"/>
<area shape="rect" href="group__fat16.html#gacdc9da639a6ccdac9847aaba559f9ef0" title=" " alt="" coords="5,5,116,32"/>
<area shape="poly" title=" " alt="" coords="148,21,116,21,116,16,148,16"/>
</map>
</div>

</div>
</div>
<a id="ga73c8f0598e8224736b09644c48cf2970" name="ga73c8f0598e8224736b09644c48cf2970"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga73c8f0598e8224736b09644c48cf2970">&#9670;&#160;</a></span>fat16_read_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t fat16_read_dir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dir_entry</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the next directory entry contained within a parent directory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dd</td><td>The descriptor of the parent directory from which to read the entry. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dir_entry</td><td>Pointer to a buffer into which to write the directory entry information. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on failure, 1 on success. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__dir.html#gaaed63addc9b9a3d5137f3b552abb42d8" title="Resets a directory handle.">fat16_reset_dir</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01249">1249</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1250</span>{</div>
<div class="line"><span class="lineno"> 1251</span>    <span class="keywordflow">if</span>(!dd || !dir_entry)</div>
<div class="line"><span class="lineno"> 1252</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span>    <span class="keywordflow">if</span>(dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#a5549da6db7a16c0a5c6b2016cf0826d6">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8bbd1a1339bd035f916ffe91420cc8ad">cluster</a> == 0)</div>
<div class="line"><span class="lineno"> 1255</span>    {</div>
<div class="line"><span class="lineno"> 1256</span>        <span class="comment">/* read entry from root directory */</span></div>
<div class="line"><span class="lineno"> 1257</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="group__fat16__fs.html#ga2e0cd2d601f164cec718052204d257b5">fat16_read_root_dir_entry</a>(dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#a3e931a086f03c316195e59541679db6b">fs</a>, dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#ab39a3784ce8e95c38c6d45afa954ab5f">entry_next</a>, dir_entry))</div>
<div class="line"><span class="lineno"> 1258</span>        {</div>
<div class="line"><span class="lineno"> 1259</span>            ++dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#ab39a3784ce8e95c38c6d45afa954ab5f">entry_next</a>;</div>
<div class="line"><span class="lineno"> 1260</span>            <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 1261</span>        }</div>
<div class="line"><span class="lineno"> 1262</span>    }</div>
<div class="line"><span class="lineno"> 1263</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1264</span>    {</div>
<div class="line"><span class="lineno"> 1265</span>        <span class="comment">/* read entry from a subdirectory */</span></div>
<div class="line"><span class="lineno"> 1266</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="group__fat16__fs.html#gaefed7787ed7c6e2ce35f67c06aac36c7">fat16_read_sub_dir_entry</a>(dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#a3e931a086f03c316195e59541679db6b">fs</a>, dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#ab39a3784ce8e95c38c6d45afa954ab5f">entry_next</a>, &amp;dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#a5549da6db7a16c0a5c6b2016cf0826d6">dir_entry</a>, dir_entry))</div>
<div class="line"><span class="lineno"> 1267</span>        {</div>
<div class="line"><span class="lineno"> 1268</span>            ++dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#ab39a3784ce8e95c38c6d45afa954ab5f">entry_next</a>;</div>
<div class="line"><span class="lineno"> 1269</span>            <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 1270</span>        }</div>
<div class="line"><span class="lineno"> 1271</span>    }</div>
<div class="line"><span class="lineno"> 1272</span> </div>
<div class="line"><span class="lineno"> 1273</span>    <span class="comment">/* restart reading */</span></div>
<div class="line"><span class="lineno"> 1274</span>    dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#ab39a3784ce8e95c38c6d45afa954ab5f">entry_next</a> = 0;</div>
<div class="line"><span class="lineno"> 1275</span> </div>
<div class="line"><span class="lineno"> 1276</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1277</span>}</div>
<div class="ttc" id="agroup__fat16__fs_html_ga2e0cd2d601f164cec718052204d257b5"><div class="ttname"><a href="group__fat16__fs.html#ga2e0cd2d601f164cec718052204d257b5">fat16_read_root_dir_entry</a></div><div class="ttdeci">static uint8_t fat16_read_root_dir_entry(const struct fat16_fs_struct *fs, uint16_t entry_num, struct fat16_dir_entry_struct *dir_entry)</div><div class="ttdoc">Reads a directory entry of the root directory.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l00234">fat16.h:234</a></div></div>
<div class="ttc" id="agroup__fat16__fs_html_gaefed7787ed7c6e2ce35f67c06aac36c7"><div class="ttname"><a href="group__fat16__fs.html#gaefed7787ed7c6e2ce35f67c06aac36c7">fat16_read_sub_dir_entry</a></div><div class="ttdeci">static uint8_t fat16_read_sub_dir_entry(const struct fat16_fs_struct *fs, uint16_t entry_num, const struct fat16_dir_entry_struct *parent, struct fat16_dir_entry_struct *dir_entry)</div><div class="ttdoc">Reads a directory entry of a given parent directory.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l00280">fat16.h:280</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_ga73c8f0598e8224736b09644c48cf2970_cgraph.png" border="0" usemap="#agroup__fat16_ga73c8f0598e8224736b09644c48cf2970_cgraph" alt=""/></div>
<map name="agroup__fat16_ga73c8f0598e8224736b09644c48cf2970_cgraph" id="agroup__fat16_ga73c8f0598e8224736b09644c48cf2970_cgraph">
<area shape="rect" title="Reads the next directory entry contained within a parent directory." alt="" coords="5,47,108,73"/>
<area shape="rect" href="group__fat16__fs.html#ga2e0cd2d601f164cec718052204d257b5" title="Reads a directory entry of the root directory." alt="" coords="156,5,287,48"/>
<area shape="poly" title=" " alt="" coords="108,47,140,40,141,46,109,52"/>
<area shape="rect" href="group__fat16__fs.html#gaefed7787ed7c6e2ce35f67c06aac36c7" title="Reads a directory entry of a given parent directory." alt="" coords="156,72,287,115"/>
<area shape="poly" title=" " alt="" coords="109,68,141,74,140,80,108,73"/>
<area shape="rect" href="group__fat16__fs.html#ga64666f9e44e49273d33ed01058ff5fac" title="Callback function for reading a directory entry." alt="" coords="342,72,480,115"/>
<area shape="poly" title=" " alt="" coords="285,46,335,64,333,69,283,51"/>
<area shape="rect" href="group__fat16__fs.html#ga6f277c11fa202ecfadca3635221f70a4" title="Callback function for seeking through subdirectory entries." alt="" coords="341,5,482,48"/>
<area shape="poly" title=" " alt="" coords="288,24,325,24,325,29,288,29"/>
<area shape="rect" href="group__fat16__fs.html#ga8927d70d35df0d10284286e2d5b66193" title="Interprets a raw directory entry and puts the contained information into the directory entry." alt="" coords="535,72,660,115"/>
<area shape="poly" title=" " alt="" coords="481,91,520,91,520,96,481,96"/>
<area shape="poly" title=" " alt="" coords="287,91,326,91,326,96,287,96"/>
<area shape="poly" title=" " alt="" coords="283,69,333,51,335,56,285,74"/>
<area shape="rect" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a" title="Retrieves the next following cluster of a given cluster." alt="" coords="335,139,487,165"/>
<area shape="poly" title=" " alt="" coords="288,111,352,131,350,136,286,116"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_ga73c8f0598e8224736b09644c48cf2970_icgraph.png" border="0" usemap="#agroup__fat16_ga73c8f0598e8224736b09644c48cf2970_icgraph" alt=""/></div>
<map name="agroup__fat16_ga73c8f0598e8224736b09644c48cf2970_icgraph" id="agroup__fat16_ga73c8f0598e8224736b09644c48cf2970_icgraph">
<area shape="rect" title="Reads the next directory entry contained within a parent directory." alt="" coords="343,64,445,91"/>
<area shape="rect" href="group__fat16__file.html#gaf8029e3ec633902d08e8204d13afc350" title="Creates a file." alt="" coords="172,5,287,32"/>
<area shape="poly" title=" " alt="" coords="340,61,268,35,270,30,341,56"/>
<area shape="rect" href="group__fat16__file.html#ga0045fe378de2f7c52b528f985e1891a6" title="Retrieves the directory entry of a path." alt="" coords="164,56,295,99"/>
<area shape="poly" title=" " alt="" coords="327,80,295,80,295,75,327,75"/>
<area shape="rect" href="group__fat16.html#gaa25986550d47370f582118a9ef6eae24" title=" " alt="" coords="178,123,281,149"/>
<area shape="poly" title=" " alt="" coords="341,99,270,125,268,120,340,94"/>
<area shape="rect" href="group__fat16.html#gacdc9da639a6ccdac9847aaba559f9ef0" title=" " alt="" coords="5,123,116,149"/>
<area shape="poly" title=" " alt="" coords="163,139,116,139,116,133,163,133"/>
</map>
</div>

</div>
</div>
<a id="ga0af2ef3d690626a5640a334cefbb27a6" name="ga0af2ef3d690626a5640a334cefbb27a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0af2ef3d690626a5640a334cefbb27a6">&#9670;&#160;</a></span>fat16_read_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t fat16_read_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>buffer</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>buffer_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads data from a file. </p>
<p>The data requested is read from the current file location.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>The file handle of the file from which to read. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buffer</td><td>The buffer into which to write. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buffer_len</td><td>The amount of data to read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes read, 0 on end of file, or -1 on failure. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__file.html#ga4f0c785a47b1cf070839b5edec2c6f65" title="Writes data to a file.">fat16_write_file</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l00830">830</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  831</span>{</div>
<div class="line"><span class="lineno">  832</span>    <span class="comment">/* check arguments */</span></div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">if</span>(!fd || !buffer || buffer_len &lt; 1)</div>
<div class="line"><span class="lineno">  834</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>    <span class="comment">/* determine number of bytes to read */</span></div>
<div class="line"><span class="lineno">  837</span>    <span class="keywordflow">if</span>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> + buffer_len &gt; fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a20dc3151ca3727aef4ad79a7735131ff">file_size</a>)</div>
<div class="line"><span class="lineno">  838</span>        buffer_len = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a20dc3151ca3727aef4ad79a7735131ff">file_size</a> - fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a>;</div>
<div class="line"><span class="lineno">  839</span>    <span class="keywordflow">if</span>(buffer_len == 0)</div>
<div class="line"><span class="lineno">  840</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>    uint16_t cluster_size = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a724086964a23748a0585386c396b945e">cluster_size</a>;</div>
<div class="line"><span class="lineno">  843</span>    uint16_t cluster_num = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#acd6b999ba29483b8743b7efe54ddcf3e">pos_cluster</a>;</div>
<div class="line"><span class="lineno">  844</span>    uint16_t buffer_left = buffer_len;</div>
<div class="line"><span class="lineno">  845</span>    uint16_t first_cluster_offset = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> % cluster_size;</div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>    <span class="comment">/* find cluster in which to start reading */</span></div>
<div class="line"><span class="lineno">  848</span>    <span class="keywordflow">if</span>(!cluster_num)</div>
<div class="line"><span class="lineno">  849</span>    {</div>
<div class="line"><span class="lineno">  850</span>        cluster_num = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8bbd1a1339bd035f916ffe91420cc8ad">cluster</a>;</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>        <span class="keywordflow">if</span>(!cluster_num)</div>
<div class="line"><span class="lineno">  853</span>        {</div>
<div class="line"><span class="lineno">  854</span>            <span class="keywordflow">if</span>(!fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a>)</div>
<div class="line"><span class="lineno">  855</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  856</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  857</span>                <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  858</span>        }</div>
<div class="line"><span class="lineno">  859</span> </div>
<div class="line"><span class="lineno">  860</span>        <span class="keywordflow">if</span>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a>)</div>
<div class="line"><span class="lineno">  861</span>        {</div>
<div class="line"><span class="lineno">  862</span>            uint32_t pos = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a>;</div>
<div class="line"><span class="lineno">  863</span>            <span class="keywordflow">while</span>(pos &gt;= cluster_size)</div>
<div class="line"><span class="lineno">  864</span>            {</div>
<div class="line"><span class="lineno">  865</span>                pos -= cluster_size;</div>
<div class="line"><span class="lineno">  866</span>                cluster_num = <a class="code hl_function" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a">fat16_get_next_cluster</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, cluster_num);</div>
<div class="line"><span class="lineno">  867</span>                <span class="keywordflow">if</span>(!cluster_num)</div>
<div class="line"><span class="lineno">  868</span>                    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  869</span>            }</div>
<div class="line"><span class="lineno">  870</span>        }</div>
<div class="line"><span class="lineno">  871</span>    }</div>
<div class="line"><span class="lineno">  872</span> </div>
<div class="line"><span class="lineno">  873</span>    <span class="comment">/* read data */</span></div>
<div class="line"><span class="lineno">  874</span>    <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  875</span>    {</div>
<div class="line"><span class="lineno">  876</span>        <span class="comment">/* calculate data size to copy from cluster */</span></div>
<div class="line"><span class="lineno">  877</span>        uint32_t cluster_offset = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a877f23793a9b6cf783f71bf31fb18bb1">cluster_zero_offset</a> +</div>
<div class="line"><span class="lineno">  878</span>        (uint32_t) (cluster_num - 2) * cluster_size + first_cluster_offset;</div>
<div class="line"><span class="lineno">  879</span>        uint16_t copy_length = cluster_size - first_cluster_offset;</div>
<div class="line"><span class="lineno">  880</span>        <span class="keywordflow">if</span>(copy_length &gt; buffer_left)</div>
<div class="line"><span class="lineno">  881</span>            copy_length = buffer_left;</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>        <span class="comment">/* read data */</span></div>
<div class="line"><span class="lineno">  884</span>        <span class="keywordflow">if</span>(!fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#a59ba2a9a21fc39f90358fe48baa5b923">partition</a>-&gt;device_read(cluster_offset, buffer, copy_length))</div>
<div class="line"><span class="lineno">  885</span>            <span class="keywordflow">return</span> buffer_len - buffer_left;</div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="line"><span class="lineno">  887</span>        <span class="comment">/* calculate new file position */</span></div>
<div class="line"><span class="lineno">  888</span>        buffer += copy_length;</div>
<div class="line"><span class="lineno">  889</span>        buffer_left -= copy_length;</div>
<div class="line"><span class="lineno">  890</span>        fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> += copy_length;</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>        <span class="keywordflow">if</span>(first_cluster_offset + copy_length &gt;= cluster_size)</div>
<div class="line"><span class="lineno">  893</span>        {</div>
<div class="line"><span class="lineno">  894</span>            <span class="comment">/* we are on a cluster boundary, so get the next cluster */</span></div>
<div class="line"><span class="lineno">  895</span>            <span class="keywordflow">if</span>((cluster_num = <a class="code hl_function" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a">fat16_get_next_cluster</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, cluster_num)))</div>
<div class="line"><span class="lineno">  896</span>            {</div>
<div class="line"><span class="lineno">  897</span>                first_cluster_offset = 0;</div>
<div class="line"><span class="lineno">  898</span>            }</div>
<div class="line"><span class="lineno">  899</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  900</span>            {</div>
<div class="line"><span class="lineno">  901</span>                fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#acd6b999ba29483b8743b7efe54ddcf3e">pos_cluster</a> = 0;</div>
<div class="line"><span class="lineno">  902</span>                <span class="keywordflow">return</span> buffer_len - buffer_left;</div>
<div class="line"><span class="lineno">  903</span>            }</div>
<div class="line"><span class="lineno">  904</span>        }</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>        fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#acd6b999ba29483b8743b7efe54ddcf3e">pos_cluster</a> = cluster_num;</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>    }</div>
<div class="line"><span class="lineno">  909</span>    <span class="keywordflow">while</span>(buffer_left &gt; 0); <span class="comment">/* check if we are done */</span></div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>    <span class="keywordflow">return</span> buffer_len;</div>
<div class="line"><span class="lineno">  912</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_ga0af2ef3d690626a5640a334cefbb27a6_cgraph.png" border="0" usemap="#agroup__fat16_ga0af2ef3d690626a5640a334cefbb27a6_cgraph" alt=""/></div>
<map name="agroup__fat16_ga0af2ef3d690626a5640a334cefbb27a6_cgraph" id="agroup__fat16_ga0af2ef3d690626a5640a334cefbb27a6_cgraph">
<area shape="rect" title="Reads data from a file." alt="" coords="5,5,110,32"/>
<area shape="rect" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a" title="Retrieves the next following cluster of a given cluster." alt="" coords="158,5,310,32"/>
<area shape="poly" title=" " alt="" coords="110,16,142,16,142,21,110,21"/>
</map>
</div>

</div>
</div>
<a id="gaaed63addc9b9a3d5137f3b552abb42d8" name="gaaed63addc9b9a3d5137f3b552abb42d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaed63addc9b9a3d5137f3b552abb42d8">&#9670;&#160;</a></span>fat16_reset_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t fat16_reset_dir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dd</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets a directory handle. </p>
<p>Resets the directory handle such that reading restarts with the first directory entry.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dd</td><td>The directory handle to reset. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on failure, 1 on success. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__dir.html#ga73c8f0598e8224736b09644c48cf2970" title="Reads the next directory entry contained within a parent directory.">fat16_read_dir</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01290">1290</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1291</span>{</div>
<div class="line"><span class="lineno"> 1292</span>    <span class="keywordflow">if</span>(!dd)</div>
<div class="line"><span class="lineno"> 1293</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1294</span> </div>
<div class="line"><span class="lineno"> 1295</span>    dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#ab39a3784ce8e95c38c6d45afa954ab5f">entry_next</a> = 0;</div>
<div class="line"><span class="lineno"> 1296</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 1297</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_gaaed63addc9b9a3d5137f3b552abb42d8_icgraph.png" border="0" usemap="#agroup__fat16_gaaed63addc9b9a3d5137f3b552abb42d8_icgraph" alt=""/></div>
<map name="agroup__fat16_gaaed63addc9b9a3d5137f3b552abb42d8_icgraph" id="agroup__fat16_gaaed63addc9b9a3d5137f3b552abb42d8_icgraph">
<area shape="rect" title="Resets a directory handle." alt="" coords="327,31,433,57"/>
<area shape="rect" href="group__fat16__file.html#gaf8029e3ec633902d08e8204d13afc350" title="Creates a file." alt="" coords="164,5,279,32"/>
<area shape="poly" title=" " alt="" coords="311,36,279,31,280,25,312,30"/>
<area shape="rect" href="group__fat16.html#gaa25986550d47370f582118a9ef6eae24" title=" " alt="" coords="170,56,273,83"/>
<area shape="poly" title=" " alt="" coords="312,58,274,64,273,59,311,52"/>
<area shape="rect" href="group__fat16.html#gacdc9da639a6ccdac9847aaba559f9ef0" title=" " alt="" coords="5,56,116,83"/>
<area shape="poly" title=" " alt="" coords="154,72,116,72,116,67,154,67"/>
</map>
</div>

</div>
</div>
<a id="ga23740742fa60ca148ef098caac7085c0" name="ga23740742fa60ca148ef098caac7085c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga23740742fa60ca148ef098caac7085c0">&#9670;&#160;</a></span>fat16_resize_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t fat16_resize_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resizes a file to have a specific size. </p>
<p>Enlarges or shrinks the file pointed to by the file descriptor to have exactly the specified size.</p>
<p>If the file is truncated, all bytes having an equal or larger offset than the given size are lost. If the file is expanded, the additional bytes are allocated.</p>
<dl class="section note"><dt>Note</dt><dd>Please be aware that this function just allocates or deallocates disk space, it does not explicitely clear it. To avoid data leakage, this must be done manually.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>The file decriptor of the file which to resize. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>The new size of the file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on failure, 1 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01116">1116</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1117</span>{</div>
<div class="line"><span class="lineno"> 1118</span><span class="preprocessor">    #if FAT16_WRITE_SUPPORT</span></div>
<div class="line"><span class="lineno"> 1119</span>        <span class="keywordflow">if</span>(!fd)</div>
<div class="line"><span class="lineno"> 1120</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1121</span>    </div>
<div class="line"><span class="lineno"> 1122</span>        uint16_t cluster_num = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8bbd1a1339bd035f916ffe91420cc8ad">cluster</a>;</div>
<div class="line"><span class="lineno"> 1123</span>        uint16_t cluster_size = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a724086964a23748a0585386c396b945e">cluster_size</a>;</div>
<div class="line"><span class="lineno"> 1124</span>        uint32_t size_new = size;</div>
<div class="line"><span class="lineno"> 1125</span>    </div>
<div class="line"><span class="lineno"> 1126</span>        <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno"> 1127</span>        {</div>
<div class="line"><span class="lineno"> 1128</span>            <span class="keywordflow">if</span>(cluster_num == 0 &amp;&amp; size_new == 0)</div>
<div class="line"><span class="lineno"> 1129</span>        <span class="comment">/* the file stays empty */</span></div>
<div class="line"><span class="lineno"> 1130</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1131</span>    </div>
<div class="line"><span class="lineno"> 1132</span>            <span class="comment">/* seek to the next cluster as long as we need the space */</span></div>
<div class="line"><span class="lineno"> 1133</span>            <span class="keywordflow">while</span>(size_new &gt; cluster_size)</div>
<div class="line"><span class="lineno"> 1134</span>            {</div>
<div class="line"><span class="lineno"> 1135</span>                <span class="comment">/* get next cluster of file */</span></div>
<div class="line"><span class="lineno"> 1136</span>                uint16_t cluster_num_next = <a class="code hl_function" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a">fat16_get_next_cluster</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, cluster_num);</div>
<div class="line"><span class="lineno"> 1137</span>                <span class="keywordflow">if</span>(cluster_num_next)</div>
<div class="line"><span class="lineno"> 1138</span>                {</div>
<div class="line"><span class="lineno"> 1139</span>                    cluster_num = cluster_num_next;</div>
<div class="line"><span class="lineno"> 1140</span>                    size_new -= cluster_size;</div>
<div class="line"><span class="lineno"> 1141</span>                }</div>
<div class="line"><span class="lineno"> 1142</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1143</span>                {</div>
<div class="line"><span class="lineno"> 1144</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1145</span>                }</div>
<div class="line"><span class="lineno"> 1146</span>            }</div>
<div class="line"><span class="lineno"> 1147</span>    </div>
<div class="line"><span class="lineno"> 1148</span>            <span class="keywordflow">if</span>(size_new &gt; cluster_size || cluster_num == 0)</div>
<div class="line"><span class="lineno"> 1149</span>            {</div>
<div class="line"><span class="lineno"> 1150</span>                <span class="comment">/* Allocate new cluster chain and append</span></div>
<div class="line"><span class="lineno"> 1151</span><span class="comment">                                                             * it to the existing one, if available.</span></div>
<div class="line"><span class="lineno"> 1152</span><span class="comment">                                                             */</span></div>
<div class="line"><span class="lineno"> 1153</span>                uint16_t cluster_count = size_new / cluster_size;</div>
<div class="line"><span class="lineno"> 1154</span>                <span class="keywordflow">if</span>((uint32_t) cluster_count * cluster_size &lt; size_new)</div>
<div class="line"><span class="lineno"> 1155</span>                    ++cluster_count;</div>
<div class="line"><span class="lineno"> 1156</span>                uint16_t cluster_new_chain = <a class="code hl_function" href="group__fat16__fs.html#ga7c2bf1884a5d396916b4581e15eb6992">fat16_append_clusters</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, cluster_num, cluster_count);</div>
<div class="line"><span class="lineno"> 1157</span>                <span class="keywordflow">if</span>(!cluster_new_chain)</div>
<div class="line"><span class="lineno"> 1158</span>                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1159</span>    </div>
<div class="line"><span class="lineno"> 1160</span>                <span class="keywordflow">if</span>(!cluster_num)</div>
<div class="line"><span class="lineno"> 1161</span>                {</div>
<div class="line"><span class="lineno"> 1162</span>                    cluster_num = cluster_new_chain;</div>
<div class="line"><span class="lineno"> 1163</span>                    fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8bbd1a1339bd035f916ffe91420cc8ad">cluster</a> = cluster_num;</div>
<div class="line"><span class="lineno"> 1164</span>                }</div>
<div class="line"><span class="lineno"> 1165</span>            }</div>
<div class="line"><span class="lineno"> 1166</span>    </div>
<div class="line"><span class="lineno"> 1167</span>            <span class="comment">/* write new directory entry */</span></div>
<div class="line"><span class="lineno"> 1168</span>            fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a20dc3151ca3727aef4ad79a7735131ff">file_size</a> = size;</div>
<div class="line"><span class="lineno"> 1169</span>            <span class="keywordflow">if</span>(size == 0)</div>
<div class="line"><span class="lineno"> 1170</span>                fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8bbd1a1339bd035f916ffe91420cc8ad">cluster</a> = 0;</div>
<div class="line"><span class="lineno"> 1171</span>            <span class="keywordflow">if</span>(!<a class="code hl_function" href="group__fat16__fs.html#gaa8e109c4e412a52e117f01aab14831c9">fat16_write_dir_entry</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, &amp;fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>))</div>
<div class="line"><span class="lineno"> 1172</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1173</span>    </div>
<div class="line"><span class="lineno"> 1174</span>            <span class="keywordflow">if</span>(size == 0)</div>
<div class="line"><span class="lineno"> 1175</span>            {</div>
<div class="line"><span class="lineno"> 1176</span>                <span class="comment">/* free all clusters of file */</span></div>
<div class="line"><span class="lineno"> 1177</span>                <a class="code hl_function" href="group__fat16__fs.html#gadef154e10fea9a769262e22c4bbfa383">fat16_free_clusters</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, cluster_num);</div>
<div class="line"><span class="lineno"> 1178</span>            }</div>
<div class="line"><span class="lineno"> 1179</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(size_new &lt;= cluster_size)</div>
<div class="line"><span class="lineno"> 1180</span>            {</div>
<div class="line"><span class="lineno"> 1181</span>                <span class="comment">/* free all clusters no longer needed */</span></div>
<div class="line"><span class="lineno"> 1182</span>                <a class="code hl_function" href="group__fat16__fs.html#gad1da920ff8c1a617522bbfa21972e4c7">fat16_terminate_clusters</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, cluster_num);</div>
<div class="line"><span class="lineno"> 1183</span>            }</div>
<div class="line"><span class="lineno"> 1184</span>    </div>
<div class="line"><span class="lineno"> 1185</span>        }</div>
<div class="line"><span class="lineno"> 1186</span>        <span class="keywordflow">while</span>(0);</div>
<div class="line"><span class="lineno"> 1187</span>    </div>
<div class="line"><span class="lineno"> 1188</span>        <span class="comment">/* correct file position */</span></div>
<div class="line"><span class="lineno"> 1189</span>        <span class="keywordflow">if</span>(size &lt; fd-&gt;pos)</div>
<div class="line"><span class="lineno"> 1190</span>        {</div>
<div class="line"><span class="lineno"> 1191</span>            fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> = size;</div>
<div class="line"><span class="lineno"> 1192</span>            fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#acd6b999ba29483b8743b7efe54ddcf3e">pos_cluster</a> = 0;</div>
<div class="line"><span class="lineno"> 1193</span>        }</div>
<div class="line"><span class="lineno"> 1194</span>    </div>
<div class="line"><span class="lineno"> 1195</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 1196</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno"> 1197</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1198</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 1199</span>}</div>
<div class="ttc" id="agroup__fat16__fs_html_gad1da920ff8c1a617522bbfa21972e4c7"><div class="ttname"><a href="group__fat16__fs.html#gad1da920ff8c1a617522bbfa21972e4c7">fat16_terminate_clusters</a></div><div class="ttdeci">static uint8_t fat16_terminate_clusters(const struct fat16_fs_struct *fs, uint16_t cluster_num)</div><div class="ttdoc">Frees a part of a cluster chain and correctly terminates the rest.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l00756">fat16.h:756</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_ga23740742fa60ca148ef098caac7085c0_cgraph.png" border="0" usemap="#agroup__fat16_ga23740742fa60ca148ef098caac7085c0_cgraph" alt=""/></div>
<map name="agroup__fat16_ga23740742fa60ca148ef098caac7085c0_cgraph" id="agroup__fat16_ga23740742fa60ca148ef098caac7085c0_cgraph">
<area shape="rect" title="Resizes a file to have a specific size." alt="" coords="5,107,120,133"/>
<area shape="rect" href="group__fat16__fs.html#ga7c2bf1884a5d396916b4581e15eb6992" title="Appends a new cluster chain to an existing one." alt="" coords="174,5,325,32"/>
<area shape="poly" title=" " alt="" coords="80,104,119,77,166,48,193,36,196,41,169,53,122,81,83,108"/>
<area shape="rect" href="group__fat16__fs.html#gadef154e10fea9a769262e22c4bbfa383" title="Frees a cluster chain, or a part thereof." alt="" coords="390,56,520,83"/>
<area shape="poly" title=" " alt="" coords="114,103,167,92,275,78,374,70,375,76,276,84,168,97,115,109"/>
<area shape="rect" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a" title="Retrieves the next following cluster of a given cluster." alt="" coords="379,132,531,159"/>
<area shape="poly" title=" " alt="" coords="111,131,168,143,269,149,364,148,364,153,269,154,167,148,110,137"/>
<area shape="rect" href="group__fat16__fs.html#gad1da920ff8c1a617522bbfa21972e4c7" title="Frees a part of a cluster chain and correctly terminates the rest." alt="" coords="168,107,331,133"/>
<area shape="poly" title=" " alt="" coords="120,117,152,117,152,123,120,123"/>
<area shape="rect" href="group__fat16__fs.html#gaa8e109c4e412a52e117f01aab14831c9" title="Writes a directory entry to disk." alt="" coords="179,208,320,235"/>
<area shape="poly" title=" " alt="" coords="83,132,122,159,169,187,196,199,193,204,166,192,119,163,80,136"/>
<area shape="poly" title=" " alt="" coords="307,30,384,49,383,54,306,35"/>
<area shape="poly" title=" " alt="" coords="306,103,383,84,384,90,307,109"/>
<area shape="poly" title=" " alt="" coords="332,127,364,131,363,137,331,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_ga23740742fa60ca148ef098caac7085c0_icgraph.png" border="0" usemap="#agroup__fat16_ga23740742fa60ca148ef098caac7085c0_icgraph" alt=""/></div>
<map name="agroup__fat16_ga23740742fa60ca148ef098caac7085c0_icgraph" id="agroup__fat16_ga23740742fa60ca148ef098caac7085c0_icgraph">
<area shape="rect" title="Resizes a file to have a specific size." alt="" coords="161,5,275,32"/>
<area shape="rect" href="group__fat16__file.html#gaf1511fd1a5419d0828265566dc5d33e4" title="Repositions the read/write file offset." alt="" coords="5,5,113,32"/>
<area shape="poly" title=" " alt="" coords="145,21,113,21,113,16,145,16"/>
</map>
</div>

</div>
</div>
<a id="gaf1511fd1a5419d0828265566dc5d33e4" name="gaf1511fd1a5419d0828265566dc5d33e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf1511fd1a5419d0828265566dc5d33e4">&#9670;&#160;</a></span>fat16_seek_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t fat16_seek_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *</td>          <td class="paramname"><span class="paramname"><em>offset</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>whence</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Repositions the read/write file offset. </p>
<p>Changes the file offset where the next call to <a class="el" href="group__fat16__file.html#ga0af2ef3d690626a5640a334cefbb27a6" title="Reads data from a file.">fat16_read_file()</a> or <a class="el" href="group__fat16__file.html#ga4f0c785a47b1cf070839b5edec2c6f65" title="Writes data to a file.">fat16_write_file()</a> starts reading/writing.</p>
<p>If the new offset is beyond the end of the file, <a class="el" href="group__fat16__file.html#ga23740742fa60ca148ef098caac7085c0" title="Resizes a file to have a specific size.">fat16_resize_file()</a> is implicitly called, i.e. the file is expanded.</p>
<p>The new offset can be given in different ways determined by the <code>whence</code> parameter:</p><ul>
<li><b>FAT16_SEEK_SET:</b> <code>*offset</code> is relative to the beginning of the file.</li>
<li><b>FAT16_SEEK_CUR:</b> <code>*offset</code> is relative to the current file position.</li>
<li><b>FAT16_SEEK_END:</b> <code>*offset</code> is relative to the end of the file.</li>
</ul>
<p>The resulting absolute offset is written to the location the <code>offset</code> parameter points to.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>The file decriptor of the file on which to seek. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">offset</td><td>A pointer to the new offset, as affected by the <code>whence</code> parameter. The function writes the new absolute offset to this location before it returns. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">whence</td><td>Affects the way <code>offset</code> is interpreted, see above. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on failure, 1 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01066">1066</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1067</span>{</div>
<div class="line"><span class="lineno"> 1068</span>    <span class="keywordflow">if</span>(!fd || !offset)</div>
<div class="line"><span class="lineno"> 1069</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1070</span> </div>
<div class="line"><span class="lineno"> 1071</span>    uint32_t new_pos = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a>;</div>
<div class="line"><span class="lineno"> 1072</span>    <span class="keywordflow">switch</span>(whence)</div>
<div class="line"><span class="lineno"> 1073</span>    {</div>
<div class="line"><span class="lineno"> 1074</span>        <span class="keywordflow">case</span> <a class="code hl_define" href="group__fat16__file.html#gab90aeb34840c0ea33c8ae9d7577def65">FAT16_SEEK_SET</a>:</div>
<div class="line"><span class="lineno"> 1075</span>            new_pos = *offset;</div>
<div class="line"><span class="lineno"> 1076</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1077</span>        <span class="keywordflow">case</span> <a class="code hl_define" href="group__fat16__file.html#ga432820c6f8c90e11a92efc931c3b8a3a">FAT16_SEEK_CUR</a>:</div>
<div class="line"><span class="lineno"> 1078</span>            new_pos += *offset;</div>
<div class="line"><span class="lineno"> 1079</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1080</span>        <span class="keywordflow">case</span> <a class="code hl_define" href="group__fat16__file.html#ga3793e580ccfcd5e68b95a0740c000e39">FAT16_SEEK_END</a>:</div>
<div class="line"><span class="lineno"> 1081</span>            new_pos = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a20dc3151ca3727aef4ad79a7735131ff">file_size</a> + *offset;</div>
<div class="line"><span class="lineno"> 1082</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1083</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1084</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1085</span>    }</div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span>    <span class="keywordflow">if</span>(new_pos &gt; fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a20dc3151ca3727aef4ad79a7735131ff">file_size</a> &amp;&amp; !<a class="code hl_function" href="group__fat16__file.html#ga23740742fa60ca148ef098caac7085c0">fat16_resize_file</a>(fd, new_pos))</div>
<div class="line"><span class="lineno"> 1088</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1089</span> </div>
<div class="line"><span class="lineno"> 1090</span>    fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> = new_pos;</div>
<div class="line"><span class="lineno"> 1091</span>    fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#acd6b999ba29483b8743b7efe54ddcf3e">pos_cluster</a> = 0;</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>    *offset = new_pos;</div>
<div class="line"><span class="lineno"> 1094</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 1095</span>}</div>
<div class="ttc" id="agroup__fat16__file_html_ga23740742fa60ca148ef098caac7085c0"><div class="ttname"><a href="group__fat16__file.html#ga23740742fa60ca148ef098caac7085c0">fat16_resize_file</a></div><div class="ttdeci">uint8_t fat16_resize_file(struct fat16_file_struct *fd, uint32_t size)</div><div class="ttdoc">Resizes a file to have a specific size.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l01116">fat16.h:1116</a></div></div>
<div class="ttc" id="agroup__fat16__file_html_ga3793e580ccfcd5e68b95a0740c000e39"><div class="ttname"><a href="group__fat16__file.html#ga3793e580ccfcd5e68b95a0740c000e39">FAT16_SEEK_END</a></div><div class="ttdeci">#define FAT16_SEEK_END</div><div class="ttdoc">The given offset is relative to the end of the file.</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00050">fat16_header.h:50</a></div></div>
<div class="ttc" id="agroup__fat16__file_html_ga432820c6f8c90e11a92efc931c3b8a3a"><div class="ttname"><a href="group__fat16__file.html#ga432820c6f8c90e11a92efc931c3b8a3a">FAT16_SEEK_CUR</a></div><div class="ttdeci">#define FAT16_SEEK_CUR</div><div class="ttdoc">The given offset is relative to the current read/write position.</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00048">fat16_header.h:48</a></div></div>
<div class="ttc" id="agroup__fat16__file_html_gab90aeb34840c0ea33c8ae9d7577def65"><div class="ttname"><a href="group__fat16__file.html#gab90aeb34840c0ea33c8ae9d7577def65">FAT16_SEEK_SET</a></div><div class="ttdeci">#define FAT16_SEEK_SET</div><div class="ttdoc">The given offset is relative to the beginning of the file.</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00046">fat16_header.h:46</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_gaf1511fd1a5419d0828265566dc5d33e4_cgraph.png" border="0" usemap="#agroup__fat16_gaf1511fd1a5419d0828265566dc5d33e4_cgraph" alt=""/></div>
<map name="agroup__fat16_gaf1511fd1a5419d0828265566dc5d33e4_cgraph" id="agroup__fat16_gaf1511fd1a5419d0828265566dc5d33e4_cgraph">
<area shape="rect" title="Repositions the read/write file offset." alt="" coords="5,107,113,133"/>
<area shape="rect" href="group__fat16__file.html#ga23740742fa60ca148ef098caac7085c0" title="Resizes a file to have a specific size." alt="" coords="161,107,275,133"/>
<area shape="poly" title=" " alt="" coords="113,117,145,117,145,123,113,123"/>
<area shape="rect" href="group__fat16__fs.html#ga7c2bf1884a5d396916b4581e15eb6992" title="Appends a new cluster chain to an existing one." alt="" coords="329,5,480,32"/>
<area shape="poly" title=" " alt="" coords="236,104,274,77,322,48,349,36,351,41,324,53,277,81,239,108"/>
<area shape="rect" href="group__fat16__fs.html#gadef154e10fea9a769262e22c4bbfa383" title="Frees a cluster chain, or a part thereof." alt="" coords="545,56,676,83"/>
<area shape="poly" title=" " alt="" coords="269,103,323,92,431,78,530,70,530,76,431,84,323,97,270,109"/>
<area shape="rect" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a" title="Retrieves the next following cluster of a given cluster." alt="" coords="534,132,687,159"/>
<area shape="poly" title=" " alt="" coords="266,131,323,143,424,149,519,148,519,153,424,154,323,148,265,137"/>
<area shape="rect" href="group__fat16__fs.html#gad1da920ff8c1a617522bbfa21972e4c7" title="Frees a part of a cluster chain and correctly terminates the rest." alt="" coords="323,107,486,133"/>
<area shape="poly" title=" " alt="" coords="275,117,307,117,307,123,275,123"/>
<area shape="rect" href="group__fat16__fs.html#gaa8e109c4e412a52e117f01aab14831c9" title="Writes a directory entry to disk." alt="" coords="335,208,475,235"/>
<area shape="poly" title=" " alt="" coords="239,132,277,159,324,187,351,199,349,204,322,192,274,163,236,136"/>
<area shape="poly" title=" " alt="" coords="463,30,539,49,538,54,461,35"/>
<area shape="poly" title=" " alt="" coords="461,103,538,84,539,90,463,109"/>
<area shape="poly" title=" " alt="" coords="487,127,519,131,519,137,487,133"/>
</map>
</div>

</div>
</div>
<a id="gad2e7cbfa7a5f7c2893b7999663599901" name="gad2e7cbfa7a5f7c2893b7999663599901"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad2e7cbfa7a5f7c2893b7999663599901">&#9670;&#160;</a></span>fat16_set_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t fat16_set_dir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01299">1299</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1300</span>{</div>
<div class="line"><span class="lineno"> 1301</span>    <span class="keywordflow">if</span>(!dd)</div>
<div class="line"><span class="lineno"> 1302</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1303</span> </div>
<div class="line"><span class="lineno"> 1304</span>    dd-&gt;<a class="code hl_variable" href="structfat16__dir__struct.html#ab39a3784ce8e95c38c6d45afa954ab5f">entry_next</a> = offset;</div>
<div class="line"><span class="lineno"> 1305</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 1306</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga4f0c785a47b1cf070839b5edec2c6f65" name="ga4f0c785a47b1cf070839b5edec2c6f65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4f0c785a47b1cf070839b5edec2c6f65">&#9670;&#160;</a></span>fat16_write_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t fat16_write_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>buffer</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>buffer_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes data to a file. </p>
<p>The data is written to the current file location.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>The file handle of the file to which to write. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buffer</td><td>The buffer from which to read the data to be written. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buffer_len</td><td>The amount of data to write. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes written, 0 on disk full, or -1 on failure. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__fat16__file.html#ga0af2ef3d690626a5640a334cefbb27a6" title="Reads data from a file.">fat16_read_file</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l00926">926</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  926</span>                                                                                                   {</div>
<div class="line"><span class="lineno">  927</span>    <span class="keywordflow">if</span>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a2e6afeba0fa2950162794e5357d686e8">magic_cookie</a>!=<a class="code hl_define" href="fat16_8h.html#a194317b66cbc9cb4f9e897096333026f">FD_MAGIC_COOKIE</a>) <span class="keywordflow">return</span> -7;</div>
<div class="line"><span class="lineno">  928</span><span class="preprocessor">    #if FAT16_WRITE_SUPPORT</span></div>
<div class="line"><span class="lineno">  929</span>        <span class="comment">/* check arguments */</span></div>
<div class="line"><span class="lineno">  930</span>        <span class="keywordflow">if</span>(!fd || buffer_len &lt; 1)</div>
<div class="line"><span class="lineno">  931</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  932</span>        <span class="keywordflow">if</span>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> &gt; fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a20dc3151ca3727aef4ad79a7735131ff">file_size</a>)</div>
<div class="line"><span class="lineno">  933</span>            <span class="keywordflow">return</span> -2;</div>
<div class="line"><span class="lineno">  934</span>    </div>
<div class="line"><span class="lineno">  935</span>        uint16_t cluster_size = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a724086964a23748a0585386c396b945e">cluster_size</a>;</div>
<div class="line"><span class="lineno">  936</span>        uint16_t cluster_num = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#acd6b999ba29483b8743b7efe54ddcf3e">pos_cluster</a>;</div>
<div class="line"><span class="lineno">  937</span>        uint16_t buffer_left = buffer_len;</div>
<div class="line"><span class="lineno">  938</span>        uint16_t first_cluster_offset = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> % cluster_size;</div>
<div class="line"><span class="lineno">  939</span>    </div>
<div class="line"><span class="lineno">  940</span>        <span class="comment">/* find cluster in which to start writing */</span></div>
<div class="line"><span class="lineno">  941</span>        <span class="keywordflow">if</span>(!cluster_num) {</div>
<div class="line"><span class="lineno">  942</span>            cluster_num = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8bbd1a1339bd035f916ffe91420cc8ad">cluster</a>;</div>
<div class="line"><span class="lineno">  943</span>    </div>
<div class="line"><span class="lineno">  944</span>            <span class="keywordflow">if</span>(!cluster_num) {</div>
<div class="line"><span class="lineno">  945</span>                <span class="keywordflow">if</span>(!fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a>) {</div>
<div class="line"><span class="lineno">  946</span>                    <span class="comment">/* empty file */</span></div>
<div class="line"><span class="lineno">  947</span>                    fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a8bbd1a1339bd035f916ffe91420cc8ad">cluster</a> = cluster_num = <a class="code hl_function" href="group__fat16__fs.html#ga7c2bf1884a5d396916b4581e15eb6992">fat16_append_clusters</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, 0, 1);</div>
<div class="line"><span class="lineno">  948</span>                    <span class="keywordflow">if</span>(!cluster_num)</div>
<div class="line"><span class="lineno">  949</span>                        <span class="keywordflow">return</span> -3;</div>
<div class="line"><span class="lineno">  950</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  951</span>                    <span class="keywordflow">return</span> -4;</div>
<div class="line"><span class="lineno">  952</span>                }</div>
<div class="line"><span class="lineno">  953</span>            }</div>
<div class="line"><span class="lineno">  954</span>    </div>
<div class="line"><span class="lineno">  955</span>            <span class="keywordflow">if</span>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a>) {</div>
<div class="line"><span class="lineno">  956</span>                uint32_t pos = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a>;</div>
<div class="line"><span class="lineno">  957</span>                uint16_t cluster_num_next;</div>
<div class="line"><span class="lineno">  958</span>                <span class="keywordflow">while</span>(pos &gt;= cluster_size) {</div>
<div class="line"><span class="lineno">  959</span>                    pos -= cluster_size;</div>
<div class="line"><span class="lineno">  960</span>                    cluster_num_next = <a class="code hl_function" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a">fat16_get_next_cluster</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, cluster_num);</div>
<div class="line"><span class="lineno">  961</span>                    <span class="keywordflow">if</span>(!cluster_num_next &amp;&amp; pos == 0)</div>
<div class="line"><span class="lineno">  962</span>        <span class="comment">/* the file exactly ends on a cluster boundary, and we append to it */</span></div>
<div class="line"><span class="lineno">  963</span>                        cluster_num_next = <a class="code hl_function" href="group__fat16__fs.html#ga7c2bf1884a5d396916b4581e15eb6992">fat16_append_clusters</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, cluster_num, 1);</div>
<div class="line"><span class="lineno">  964</span>                    <span class="keywordflow">if</span>(!cluster_num_next)</div>
<div class="line"><span class="lineno">  965</span>                        <span class="keywordflow">return</span> -5;</div>
<div class="line"><span class="lineno">  966</span>    </div>
<div class="line"><span class="lineno">  967</span>                    cluster_num = cluster_num_next;</div>
<div class="line"><span class="lineno">  968</span>                }</div>
<div class="line"><span class="lineno">  969</span>            }</div>
<div class="line"><span class="lineno">  970</span>        }</div>
<div class="line"><span class="lineno">  971</span>    </div>
<div class="line"><span class="lineno">  972</span>        <span class="comment">/* write data */</span></div>
<div class="line"><span class="lineno">  973</span>        <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  974</span>        {</div>
<div class="line"><span class="lineno">  975</span>            <span class="comment">/* calculate data size to write to cluster */</span></div>
<div class="line"><span class="lineno">  976</span>            uint32_t cluster_offset = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#ad1287906321608dc2aa7741324dca9b5">header</a>.<a class="code hl_variable" href="structfat16__header__struct.html#a877f23793a9b6cf783f71bf31fb18bb1">cluster_zero_offset</a> +</div>
<div class="line"><span class="lineno">  977</span>            (uint32_t) (cluster_num - 2) * cluster_size + first_cluster_offset;</div>
<div class="line"><span class="lineno">  978</span>            uint16_t write_length = cluster_size - first_cluster_offset;</div>
<div class="line"><span class="lineno">  979</span>            <span class="keywordflow">if</span>(write_length &gt; buffer_left)</div>
<div class="line"><span class="lineno">  980</span>                write_length = buffer_left;</div>
<div class="line"><span class="lineno">  981</span>    </div>
<div class="line"><span class="lineno">  982</span>            <span class="comment">/* write data which fits into the current cluster */</span></div>
<div class="line"><span class="lineno">  983</span>            <span class="keywordflow">if</span>(!fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>-&gt;<a class="code hl_variable" href="structfat16__fs__struct.html#a59ba2a9a21fc39f90358fe48baa5b923">partition</a>-&gt;device_write(cluster_offset, buffer, write_length))</div>
<div class="line"><span class="lineno">  984</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  985</span>    </div>
<div class="line"><span class="lineno">  986</span>            <span class="comment">/* calculate new file position */</span></div>
<div class="line"><span class="lineno">  987</span>            buffer += write_length;</div>
<div class="line"><span class="lineno">  988</span>            buffer_left -= write_length;</div>
<div class="line"><span class="lineno">  989</span>            fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> += write_length;</div>
<div class="line"><span class="lineno">  990</span>    </div>
<div class="line"><span class="lineno">  991</span>            <span class="keywordflow">if</span>(first_cluster_offset + write_length &gt;= cluster_size)</div>
<div class="line"><span class="lineno">  992</span>            {</div>
<div class="line"><span class="lineno">  993</span>                <span class="comment">/* we are on a cluster boundary, so get the next cluster */</span></div>
<div class="line"><span class="lineno">  994</span>                uint16_t cluster_num_next = <a class="code hl_function" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a">fat16_get_next_cluster</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, cluster_num);</div>
<div class="line"><span class="lineno">  995</span>                <span class="keywordflow">if</span>(!cluster_num_next &amp;&amp; buffer_left &gt; 0)</div>
<div class="line"><span class="lineno">  996</span>        <span class="comment">/* we reached the last cluster, append a new one */</span></div>
<div class="line"><span class="lineno">  997</span>                    cluster_num_next = <a class="code hl_function" href="group__fat16__fs.html#ga7c2bf1884a5d396916b4581e15eb6992">fat16_append_clusters</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, cluster_num, 1);</div>
<div class="line"><span class="lineno">  998</span>                <span class="keywordflow">if</span>(!cluster_num_next)</div>
<div class="line"><span class="lineno">  999</span>                {</div>
<div class="line"><span class="lineno"> 1000</span>                    fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#acd6b999ba29483b8743b7efe54ddcf3e">pos_cluster</a> = 0;</div>
<div class="line"><span class="lineno"> 1001</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1002</span>                }</div>
<div class="line"><span class="lineno"> 1003</span>    </div>
<div class="line"><span class="lineno"> 1004</span>                cluster_num = cluster_num_next;</div>
<div class="line"><span class="lineno"> 1005</span>                first_cluster_offset = 0;</div>
<div class="line"><span class="lineno"> 1006</span>            }</div>
<div class="line"><span class="lineno"> 1007</span>    </div>
<div class="line"><span class="lineno"> 1008</span>            fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#acd6b999ba29483b8743b7efe54ddcf3e">pos_cluster</a> = cluster_num;</div>
<div class="line"><span class="lineno"> 1009</span>    </div>
<div class="line"><span class="lineno"> 1010</span>        }</div>
<div class="line"><span class="lineno"> 1011</span>        <span class="keywordflow">while</span>(buffer_left &gt; 0); <span class="comment">/* check if we are done */</span></div>
<div class="line"><span class="lineno"> 1012</span>    </div>
<div class="line"><span class="lineno"> 1013</span>        <span class="comment">/* update directory entry */</span></div>
<div class="line"><span class="lineno"> 1014</span>        <span class="keywordflow">if</span>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> &gt; fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a20dc3151ca3727aef4ad79a7735131ff">file_size</a>)</div>
<div class="line"><span class="lineno"> 1015</span>        {</div>
<div class="line"><span class="lineno"> 1016</span>            uint32_t size_old = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a20dc3151ca3727aef4ad79a7735131ff">file_size</a>;</div>
<div class="line"><span class="lineno"> 1017</span>    </div>
<div class="line"><span class="lineno"> 1018</span>            <span class="comment">/* update file size */</span></div>
<div class="line"><span class="lineno"> 1019</span>            fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>.<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a20dc3151ca3727aef4ad79a7735131ff">file_size</a> = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a>;</div>
<div class="line"><span class="lineno"> 1020</span>            <span class="comment">/* write directory entry */</span></div>
<div class="line"><span class="lineno"> 1021</span>            <span class="keywordflow">if</span>(!<a class="code hl_function" href="group__fat16__fs.html#gaa8e109c4e412a52e117f01aab14831c9">fat16_write_dir_entry</a>(fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a88b18be69bd3e825f0f0346865b4811b">fs</a>, &amp;fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a1084cb148b29e32a97713c2476b8a159">dir_entry</a>))</div>
<div class="line"><span class="lineno"> 1022</span>            {</div>
<div class="line"><span class="lineno"> 1023</span>                <span class="comment">/* We do not return an error here since we actually wrote</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="comment">                                                             * some data to disk. So we calculate the amount of data</span></div>
<div class="line"><span class="lineno"> 1025</span><span class="comment">                                                             * we wrote to disk and which lies within the old file size.</span></div>
<div class="line"><span class="lineno"> 1026</span><span class="comment">                                                             */</span></div>
<div class="line"><span class="lineno"> 1027</span>                <span class="keywordflow">return</span> -8;</div>
<div class="line"><span class="lineno"> 1028</span>                buffer_left = fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> - size_old;</div>
<div class="line"><span class="lineno"> 1029</span>                fd-&gt;<a class="code hl_variable" href="structfat16__file__struct.html#a214db70a960819544d0c017739949e54">pos</a> = size_old;</div>
<div class="line"><span class="lineno"> 1030</span>            }</div>
<div class="line"><span class="lineno"> 1031</span>        }</div>
<div class="line"><span class="lineno"> 1032</span>    </div>
<div class="line"><span class="lineno"> 1033</span>        <span class="keywordflow">return</span> buffer_len - buffer_left;</div>
<div class="line"><span class="lineno"> 1034</span>    </div>
<div class="line"><span class="lineno"> 1035</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno"> 1036</span>        <span class="keywordflow">return</span> -6;</div>
<div class="line"><span class="lineno"> 1037</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 1038</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_ga4f0c785a47b1cf070839b5edec2c6f65_cgraph.png" border="0" usemap="#agroup__fat16_ga4f0c785a47b1cf070839b5edec2c6f65_cgraph" alt=""/></div>
<map name="agroup__fat16_ga4f0c785a47b1cf070839b5edec2c6f65_cgraph" id="agroup__fat16_ga4f0c785a47b1cf070839b5edec2c6f65_cgraph">
<area shape="rect" title="Writes data to a file." alt="" coords="5,56,112,83"/>
<area shape="rect" href="group__fat16__fs.html#ga7c2bf1884a5d396916b4581e15eb6992" title="Appends a new cluster chain to an existing one." alt="" coords="160,5,312,32"/>
<area shape="poly" title=" " alt="" coords="107,53,172,34,173,39,109,58"/>
<area shape="rect" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a" title="Retrieves the next following cluster of a given cluster." alt="" coords="160,56,312,83"/>
<area shape="poly" title=" " alt="" coords="112,67,144,67,144,72,112,72"/>
<area shape="rect" href="group__fat16__fs.html#gaa8e109c4e412a52e117f01aab14831c9" title="Writes a directory entry to disk." alt="" coords="166,107,306,133"/>
<area shape="poly" title=" " alt="" coords="109,81,173,99,172,105,107,86"/>
<area shape="rect" href="group__fat16__fs.html#gadef154e10fea9a769262e22c4bbfa383" title="Frees a cluster chain, or a part thereof." alt="" coords="360,5,490,32"/>
<area shape="poly" title=" " alt="" coords="312,16,345,16,345,21,312,21"/>
</map>
</div>

</div>
</div>
<a id="gaa25986550d47370f582118a9ef6eae24" name="gaa25986550d47370f582118a9ef6eae24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa25986550d47370f582118a9ef6eae24">&#9670;&#160;</a></span>find_file_in_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t find_file_in_dir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dir_entry</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01780">1780</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1781</span>{</div>
<div class="line"><span class="lineno"> 1782</span>    <span class="keywordflow">while</span>(<a class="code hl_function" href="group__fat16__dir.html#ga73c8f0598e8224736b09644c48cf2970">fat16_read_dir</a>(dd, dir_entry))</div>
<div class="line"><span class="lineno"> 1783</span>    {</div>
<div class="line"><span class="lineno"> 1784</span>        <span class="keywordflow">if</span>(strcmp(dir_entry-&gt;<a class="code hl_variable" href="structfat16__dir__entry__struct.html#a9f625c7e8ac92bd268c62089f71480d0">long_name</a>, name) == 0)</div>
<div class="line"><span class="lineno"> 1785</span>        {</div>
<div class="line"><span class="lineno"> 1786</span>            <a class="code hl_function" href="group__fat16__dir.html#gaaed63addc9b9a3d5137f3b552abb42d8">fat16_reset_dir</a>(dd);</div>
<div class="line"><span class="lineno"> 1787</span>            <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 1788</span>        }</div>
<div class="line"><span class="lineno"> 1789</span>    }</div>
<div class="line"><span class="lineno"> 1790</span> </div>
<div class="line"><span class="lineno"> 1791</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1792</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_gaa25986550d47370f582118a9ef6eae24_cgraph.png" border="0" usemap="#agroup__fat16_gaa25986550d47370f582118a9ef6eae24_cgraph" alt=""/></div>
<map name="agroup__fat16_gaa25986550d47370f582118a9ef6eae24_cgraph" id="agroup__fat16_gaa25986550d47370f582118a9ef6eae24_cgraph">
<area shape="rect" title=" " alt="" coords="5,72,108,99"/>
<area shape="rect" href="group__fat16__dir.html#ga73c8f0598e8224736b09644c48cf2970" title="Reads the next directory entry contained within a parent directory." alt="" coords="158,47,260,73"/>
<area shape="poly" title=" " alt="" coords="108,74,142,68,143,74,109,79"/>
<area shape="rect" href="group__fat16__dir.html#gaaed63addc9b9a3d5137f3b552abb42d8" title="Resets a directory handle." alt="" coords="156,97,262,124"/>
<area shape="poly" title=" " alt="" coords="109,91,141,97,140,102,108,96"/>
<area shape="rect" href="group__fat16__fs.html#ga2e0cd2d601f164cec718052204d257b5" title="Reads a directory entry of the root directory." alt="" coords="310,5,441,48"/>
<area shape="poly" title=" " alt="" coords="260,47,294,40,295,45,261,52"/>
<area shape="rect" href="group__fat16__fs.html#gaefed7787ed7c6e2ce35f67c06aac36c7" title="Reads a directory entry of a given parent directory." alt="" coords="311,72,441,115"/>
<area shape="poly" title=" " alt="" coords="261,68,296,75,295,80,260,73"/>
<area shape="rect" href="group__fat16__fs.html#ga64666f9e44e49273d33ed01058ff5fac" title="Callback function for reading a directory entry." alt="" coords="496,72,635,115"/>
<area shape="poly" title=" " alt="" coords="439,46,489,64,487,69,437,51"/>
<area shape="rect" href="group__fat16__fs.html#ga6f277c11fa202ecfadca3635221f70a4" title="Callback function for seeking through subdirectory entries." alt="" coords="495,5,636,48"/>
<area shape="poly" title=" " alt="" coords="442,24,479,24,479,29,442,29"/>
<area shape="rect" href="group__fat16__fs.html#ga8927d70d35df0d10284286e2d5b66193" title="Interprets a raw directory entry and puts the contained information into the directory entry." alt="" coords="690,72,814,115"/>
<area shape="poly" title=" " alt="" coords="635,91,674,91,674,96,635,96"/>
<area shape="poly" title=" " alt="" coords="441,91,481,91,481,96,441,96"/>
<area shape="poly" title=" " alt="" coords="437,69,487,51,489,56,439,74"/>
<area shape="rect" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a" title="Retrieves the next following cluster of a given cluster." alt="" coords="489,139,642,165"/>
<area shape="poly" title=" " alt="" coords="442,111,506,131,505,136,441,116"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_gaa25986550d47370f582118a9ef6eae24_icgraph.png" border="0" usemap="#agroup__fat16_gaa25986550d47370f582118a9ef6eae24_icgraph" alt=""/></div>
<map name="agroup__fat16_gaa25986550d47370f582118a9ef6eae24_icgraph" id="agroup__fat16_gaa25986550d47370f582118a9ef6eae24_icgraph">
<area shape="rect" title=" " alt="" coords="164,5,266,32"/>
<area shape="rect" href="group__fat16.html#gacdc9da639a6ccdac9847aaba559f9ef0" title=" " alt="" coords="5,5,116,32"/>
<area shape="poly" title=" " alt="" coords="148,21,116,21,116,16,148,16"/>
</map>
</div>

</div>
</div>
<a id="gacdc9da639a6ccdac9847aaba559f9ef0" name="gacdc9da639a6ccdac9847aaba559f9ef0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacdc9da639a6ccdac9847aaba559f9ef0">&#9670;&#160;</a></span>open_file_in_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int open_file_in_dir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfat16__file__struct.html">fat16_file_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfat16__fs__struct.html">fat16_fs_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfat16__dir__struct.html">fat16_dir_struct</a> *</td>          <td class="paramname"><span class="paramname"><em>dd</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fat16_8h_source.html#l01794">1794</a> of file <a class="el" href="fat16_8h_source.html">fat16.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1794</span>                                                                                                                              {</div>
<div class="line"><span class="lineno"> 1795</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a> file_entry;</div>
<div class="line"><span class="lineno"> 1796</span>    <span class="keywordflow">if</span>(!<a class="code hl_function" href="#gaa25986550d47370f582118a9ef6eae24">find_file_in_dir</a>(fs, dd, name, &amp;file_entry)) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1797</span> </div>
<div class="line"><span class="lineno"> 1798</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group__fat16__file.html#gaa2871189b28d8d45baea4c913b0f8438">fat16_open_file</a>(fd,fs, &amp;file_entry);</div>
<div class="line"><span class="lineno"> 1799</span>}</div>
<div class="ttc" id="agroup__fat16__file_html_gaa2871189b28d8d45baea4c913b0f8438"><div class="ttname"><a href="group__fat16__file.html#gaa2871189b28d8d45baea4c913b0f8438">fat16_open_file</a></div><div class="ttdeci">int fat16_open_file(struct fat16_file_struct *fd, struct fat16_fs_struct *fs, const struct fat16_dir_entry_struct *dir_entry)</div><div class="ttdoc">Opens a file on a FAT16 filesystem.</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l00791">fat16.h:791</a></div></div>
<div class="ttc" id="agroup__fat16_html_gaa25986550d47370f582118a9ef6eae24"><div class="ttname"><a href="#gaa25986550d47370f582118a9ef6eae24">find_file_in_dir</a></div><div class="ttdeci">uint8_t find_file_in_dir(struct fat16_fs_struct *fs, struct fat16_dir_struct *dd, const char *name, struct fat16_dir_entry_struct *dir_entry)</div><div class="ttdef"><b>Definition</b> <a href="fat16_8h_source.html#l01780">fat16.h:1780</a></div></div>
<div class="ttc" id="astructfat16__dir__entry__struct_html"><div class="ttname"><a href="structfat16__dir__entry__struct.html">fat16_dir_entry_struct</a></div><div class="ttdoc">Describes a directory entry.</div><div class="ttdef"><b>Definition</b> <a href="fat16__header_8h_source.html#l00065">fat16_header.h:65</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fat16_gacdc9da639a6ccdac9847aaba559f9ef0_cgraph.png" border="0" usemap="#agroup__fat16_gacdc9da639a6ccdac9847aaba559f9ef0_cgraph" alt=""/></div>
<map name="agroup__fat16_gacdc9da639a6ccdac9847aaba559f9ef0_cgraph" id="agroup__fat16_gacdc9da639a6ccdac9847aaba559f9ef0_cgraph">
<area shape="rect" title=" " alt="" coords="5,47,116,73"/>
<area shape="rect" href="group__fat16__file.html#gaa2871189b28d8d45baea4c913b0f8438" title="Opens a file on a FAT16 filesystem." alt="" coords="164,21,271,48"/>
<area shape="poly" title=" " alt="" coords="116,48,148,43,149,48,117,54"/>
<area shape="rect" href="group__fat16.html#gaa25986550d47370f582118a9ef6eae24" title=" " alt="" coords="166,72,269,99"/>
<area shape="poly" title=" " alt="" coords="117,66,151,72,150,77,116,72"/>
<area shape="rect" href="group__fat16__dir.html#ga73c8f0598e8224736b09644c48cf2970" title="Reads the next directory entry contained within a parent directory." alt="" coords="321,47,423,73"/>
<area shape="poly" title=" " alt="" coords="268,74,305,68,306,73,269,80"/>
<area shape="rect" href="group__fat16__dir.html#gaaed63addc9b9a3d5137f3b552abb42d8" title="Resets a directory handle." alt="" coords="319,97,425,124"/>
<area shape="poly" title=" " alt="" coords="269,91,304,97,303,102,268,96"/>
<area shape="rect" href="group__fat16__fs.html#ga2e0cd2d601f164cec718052204d257b5" title="Reads a directory entry of the root directory." alt="" coords="473,5,605,48"/>
<area shape="poly" title=" " alt="" coords="423,47,457,40,459,45,424,52"/>
<area shape="rect" href="group__fat16__fs.html#gaefed7787ed7c6e2ce35f67c06aac36c7" title="Reads a directory entry of a given parent directory." alt="" coords="474,72,604,115"/>
<area shape="poly" title=" " alt="" coords="424,68,459,75,458,80,423,73"/>
<area shape="rect" href="group__fat16__fs.html#ga64666f9e44e49273d33ed01058ff5fac" title="Callback function for reading a directory entry." alt="" coords="660,72,798,115"/>
<area shape="poly" title=" " alt="" coords="603,46,653,64,651,69,601,51"/>
<area shape="rect" href="group__fat16__fs.html#ga6f277c11fa202ecfadca3635221f70a4" title="Callback function for seeking through subdirectory entries." alt="" coords="658,5,800,48"/>
<area shape="poly" title=" " alt="" coords="605,24,642,24,642,29,605,29"/>
<area shape="rect" href="group__fat16__fs.html#ga8927d70d35df0d10284286e2d5b66193" title="Interprets a raw directory entry and puts the contained information into the directory entry." alt="" coords="853,72,977,115"/>
<area shape="poly" title=" " alt="" coords="799,91,838,91,838,96,799,96"/>
<area shape="poly" title=" " alt="" coords="605,91,644,91,644,96,605,96"/>
<area shape="poly" title=" " alt="" coords="601,69,651,51,653,56,603,74"/>
<area shape="rect" href="group__fat16__fs.html#ga80d15e5b202d3b8999f1c05d5da6be6a" title="Retrieves the next following cluster of a given cluster." alt="" coords="653,139,805,165"/>
<area shape="poly" title=" " alt="" coords="606,111,670,131,668,136,604,116"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
    <ul>
      <address class="footer">
        <a href="http://ykat.de">
        &copy 2024 ykat UG (haftungsbeschrnkt)
        </a>
        </address>
    </li>
    </ul>
  </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  </body>
  </html>